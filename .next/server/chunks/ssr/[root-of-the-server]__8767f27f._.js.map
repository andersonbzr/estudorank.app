{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/lib/supabase/client.ts"],"sourcesContent":["// src/lib/supabase/client.ts\r\nimport { createClient, type SupabaseClient } from \"@supabase/supabase-js\";\r\n\r\nlet _client: SupabaseClient | null = null;\r\n\r\n/**\r\n * Cliente do Supabase para uso no browser (componentes client).\r\n * Usa storageKey custom \"sr-auth\" para evitar conflitos e manter sess√£o.\r\n */\r\nexport function supabaseBrowser(): SupabaseClient {\r\n  if (_client) return _client;\r\n\r\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n  if (!url || !anon) {\r\n    throw new Error(\r\n      \"Env vars ausentes: defina NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\r\n    );\r\n  }\r\n\r\n  _client = createClient(url, anon, {\r\n    auth: {\r\n      persistSession: true,\r\n      autoRefreshToken: true,\r\n      storageKey: \"sr-auth\",\r\n    },\r\n  });\r\n\r\n  return _client;\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;AAC7B;;AAEA,IAAI,UAAiC;AAM9B,SAAS;IACd,IAAI,SAAS,OAAO;IAEpB,MAAM;IACN,MAAM;IAEN;;IAMA,UAAU,IAAA,uMAAY,EAAC,KAAK,MAAM;QAChC,MAAM;YACJ,gBAAgB;YAChB,kBAAkB;YAClB,YAAY;QACd;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/ui/Card.tsx"],"sourcesContent":["// src/components/ui/Card.tsx\r\n\"use client\";\r\n\r\nimport { motion } from \"framer-motion\";\r\nimport { ReactNode } from \"react\";\r\n\r\nexport default function Card({\r\n  children,\r\n  className = \"\",\r\n  as = \"div\",\r\n}: {\r\n  children: ReactNode;\r\n  className?: string;\r\n  as?: keyof JSX.IntrinsicElements;\r\n}) {\r\n  const Comp: any = as;\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 6 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      transition={{ duration: 0.18, ease: \"easeOut\" }}\r\n      whileHover={{ y: -1 }}\r\n    >\r\n      <Comp\r\n        className={`rounded-2xl border border-white/10 bg-[var(--surface)]/90 shadow-lg ${className}`}\r\n      >\r\n        {children}\r\n      </Comp>\r\n    </motion.div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;AAG7B;AAFA;;;AAKe,SAAS,KAAK,EAC3B,QAAQ,EACR,YAAY,EAAE,EACd,KAAK,KAAK,EAKX;IACC,MAAM,OAAY;IAClB,qBACE,8OAAC,oMAAM,CAAC,GAAG;QACT,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,YAAY;YAAE,UAAU;YAAM,MAAM;QAAU;QAC9C,YAAY;YAAE,GAAG,CAAC;QAAE;kBAEpB,cAAA,8OAAC;YACC,WAAW,CAAC,oEAAoE,EAAE,WAAW;sBAE5F;;;;;;;;;;;AAIT","debugId":null}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/ui/MotionButton.tsx"],"sourcesContent":["// src/components/ui/MotionButton.tsx\r\n\"use client\";\r\n\r\nimport { motion } from \"framer-motion\";\r\nimport { ButtonHTMLAttributes } from \"react\";\r\n\r\nexport default function MotionButton(\r\n  props: ButtonHTMLAttributes<HTMLButtonElement>\r\n) {\r\n  const { className = \"\", ...rest } = props;\r\n  return (\r\n    <motion.button\r\n      whileTap={{ scale: 0.98 }}\r\n      whileHover={{ scale: 1.01 }}\r\n      transition={{ duration: 0.08 }}\r\n      className={`px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 transition disabled:opacity-60 ${className}`}\r\n      {...rest}\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;;;AAGrC;AAFA;;;AAKe,SAAS,aACtB,KAA8C;IAE9C,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,MAAM,GAAG;IACpC,qBACE,8OAAC,oMAAM,CAAC,MAAM;QACZ,UAAU;YAAE,OAAO;QAAK;QACxB,YAAY;YAAE,OAAO;QAAK;QAC1B,YAAY;YAAE,UAAU;QAAK;QAC7B,WAAW,CAAC,kFAAkF,EAAE,WAAW;QAC1G,GAAG,IAAI;;;;;;AAGd","debugId":null}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/Sidebar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport {\r\n  Trophy,\r\n  LayoutDashboard,\r\n  Settings,\r\n  ShieldCheck,\r\n  Shield,\r\n} from \"lucide-react\";\r\nimport Image from \"next/image\";\r\nimport clsx from \"clsx\";\r\n\r\ntype Props = {\r\n  onNavigate?: () => void;\r\n  isAdmin?: boolean;\r\n  /** Quando true, renderiza mini-rail (√≠cones apenas) no desktop */\r\n  collapsed?: boolean;\r\n};\r\n\r\ntype Item = { href: string; label: string; icon: React.ComponentType<any> };\r\n\r\nexport default function Sidebar({\r\n  onNavigate,\r\n  isAdmin,\r\n  collapsed = false,\r\n}: Props) {\r\n  const pathname = usePathname();\r\n\r\n  const items: Item[] = [\r\n    { href: \"/me\", label: \"Meu Painel\", icon: LayoutDashboard },\r\n    { href: \"/ranking\", label: \"Ranking\", icon: Trophy },\r\n    { href: \"/config\", label: \"Configura√ß√µes\", icon: Settings },\r\n    { href: \"/me/security\", label: \"Seguran√ßa\", icon: Shield },\r\n  ];\r\n  if (isAdmin) {\r\n    items.push({\r\n      href: \"/admin/courses\",\r\n      label: \"Administra√ß√£o\",\r\n      icon: ShieldCheck,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <aside className=\"h-screen sticky top-0 bg-[var(--surface)]/80 backdrop-blur-xl border-r border-white/10 flex flex-col\">\r\n      {/* Header */}\r\n      <div\r\n        className={clsx(\r\n          \"h-14 border-b border-white/10 px-4 flex items-center gap-2\",\r\n          collapsed && \"justify-center px-0\"\r\n        )}\r\n      >\r\n        <Link\r\n          href=\"/\"\r\n          className={clsx(\r\n            \"flex items-center gap-2 transition-transform hover:scale-[1.02]\",\r\n            collapsed && \"justify-center\"\r\n          )}\r\n          onClick={onNavigate}\r\n          aria-label=\"Ir para a p√°gina inicial\"\r\n        >\r\n          <Image\r\n            src=\"/logo.png\"\r\n            alt=\"EstudoRank\"\r\n            width={collapsed ? 22 : 28}\r\n            height={collapsed ? 22 : 28}\r\n            className=\"rounded-sm drop-shadow-[0_0_6px_rgba(163,230,53,0.30)]\"\r\n            priority\r\n          />\r\n          {!collapsed && (\r\n            <span className=\"font-semibold tracking-tight\">EstudoRank</span>\r\n          )}\r\n        </Link>\r\n      </div>\r\n\r\n      {/* Navega√ß√£o */}\r\n      <nav className={clsx(\"flex-1 p-2 space-y-2\", collapsed && \"p-2\")}>\r\n        {items.map((item) => {\r\n          const active =\r\n            pathname === item.href || pathname.startsWith(`${item.href}/`);\r\n          return (\r\n            <NavItem\r\n              key={item.href}\r\n              item={item}\r\n              active={active}\r\n              collapsed={collapsed}\r\n              onNavigate={onNavigate}\r\n            />\r\n          );\r\n        })}\r\n      </nav>\r\n\r\n      {/* Footer */}\r\n      {!collapsed ? (\r\n        <div className=\"px-3 py-3 text-xs opacity-60 border-t border-white/10\">\r\n          ¬© {new Date().getFullYear()} EstudoRank\r\n        </div>\r\n      ) : (\r\n        <div className=\"py-3 border-t border-white/10 text-center text-[10px] opacity-50 select-none\">\r\n          ¬© {new Date().getFullYear()}\r\n        </div>\r\n      )}\r\n    </aside>\r\n  );\r\n}\r\n\r\n/* --------------------------- Subcomponentes --------------------------- */\r\n\r\nfunction NavItem({\r\n  item,\r\n  active,\r\n  collapsed,\r\n  onNavigate,\r\n}: {\r\n  item: Item;\r\n  active: boolean;\r\n  collapsed: boolean;\r\n  onNavigate?: () => void;\r\n}) {\r\n  const Icon = item.icon;\r\n\r\n  return (\r\n    <Link\r\n      href={item.href}\r\n      onClick={onNavigate}\r\n      aria-current={active ? \"page\" : undefined}\r\n      className={clsx(\r\n        \"group relative flex items-center gap-2 rounded-2xl border transition-all duration-200 outline-none focus-visible:ring-2 focus-visible:ring-indigo-400/40\",\r\n        collapsed ? \"justify-center p-2\" : \"px-3 py-2\",\r\n        active\r\n          ? // ‚úÖ destaque do ativo: ‚Äúpill‚Äù com leve gradiente + glow\r\n            \"bg-gradient-to-br from-lime-400/15 to-indigo-500/10 border-white/25 shadow-[0_0_0_1px_rgba(255,255,255,0.06),0_8px_24px_-8px_rgba(99,102,241,0.25)] text-lime-200\"\r\n          : \"bg-white/5 hover:bg-white/10 border-white/10 text-white/85 hover:text-white\"\r\n      )}\r\n    >\r\n      {/* √çcone */}\r\n      <Icon\r\n        size={18}\r\n        className={clsx(\r\n          \"transition-transform\",\r\n          active ? \"scale-[1.02]\" : \"group-hover:scale-105\"\r\n        )}\r\n        aria-hidden\r\n      />\r\n\r\n      {/* Label (s√≥ no modo expandido) */}\r\n      {!collapsed && <span className=\"text-sm\">{item.label}</span>}\r\n\r\n      {/* Tooltip custom (apenas no modo colapsado) */}\r\n      {collapsed && (\r\n        <span\r\n          className={clsx(\r\n            \"pointer-events-none absolute left-full ml-3 top-1/2 -translate-y-1/2\",\r\n            \"rounded-md bg-black/80 text-white text-xs px-2 py-1\",\r\n            \"opacity-0 translate-x-[-4px] group-hover:opacity-100 group-hover:translate-x-0\",\r\n            \"transition-all whitespace-nowrap z-50\"\r\n          )}\r\n          role=\"tooltip\"\r\n        >\r\n          {item.label}\r\n        </span>\r\n      )}\r\n    </Link>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AAZA;;;;;;;AAuBe,SAAS,QAAQ,EAC9B,UAAU,EACV,OAAO,EACP,YAAY,KAAK,EACX;IACN,MAAM,WAAW,IAAA,iJAAW;IAE5B,MAAM,QAAgB;QACpB;YAAE,MAAM;YAAO,OAAO;YAAc,MAAM,+OAAe;QAAC;QAC1D;YAAE,MAAM;YAAY,OAAO;YAAW,MAAM,gNAAM;QAAC;QACnD;YAAE,MAAM;YAAW,OAAO;YAAiB,MAAM,sNAAQ;QAAC;QAC1D;YAAE,MAAM;YAAgB,OAAO;YAAa,MAAM,gNAAM;QAAC;KAC1D;IACD,IAAI,SAAS;QACX,MAAM,IAAI,CAAC;YACT,MAAM;YACN,OAAO;YACP,MAAM,mOAAW;QACnB;IACF;IAEA,qBACE,8OAAC;QAAM,WAAU;;0BAEf,8OAAC;gBACC,WAAW,IAAA,gJAAI,EACb,8DACA,aAAa;0BAGf,cAAA,8OAAC,uKAAI;oBACH,MAAK;oBACL,WAAW,IAAA,gJAAI,EACb,mEACA,aAAa;oBAEf,SAAS;oBACT,cAAW;;sCAEX,8OAAC,wIAAK;4BACJ,KAAI;4BACJ,KAAI;4BACJ,OAAO,YAAY,KAAK;4BACxB,QAAQ,YAAY,KAAK;4BACzB,WAAU;4BACV,QAAQ;;;;;;wBAET,CAAC,2BACA,8OAAC;4BAAK,WAAU;sCAA+B;;;;;;;;;;;;;;;;;0BAMrD,8OAAC;gBAAI,WAAW,IAAA,gJAAI,EAAC,wBAAwB,aAAa;0BACvD,MAAM,GAAG,CAAC,CAAC;oBACV,MAAM,SACJ,aAAa,KAAK,IAAI,IAAI,SAAS,UAAU,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC;oBAC/D,qBACE,8OAAC;wBAEC,MAAM;wBACN,QAAQ;wBACR,WAAW;wBACX,YAAY;uBAJP,KAAK,IAAI;;;;;gBAOpB;;;;;;YAID,CAAC,0BACA,8OAAC;gBAAI,WAAU;;oBAAwD;oBAClE,IAAI,OAAO,WAAW;oBAAG;;;;;;qCAG9B,8OAAC;gBAAI,WAAU;;oBAA+E;oBACzF,IAAI,OAAO,WAAW;;;;;;;;;;;;;AAKnC;AAEA,0EAA0E,GAE1E,SAAS,QAAQ,EACf,IAAI,EACJ,MAAM,EACN,SAAS,EACT,UAAU,EAMX;IACC,MAAM,OAAO,KAAK,IAAI;IAEtB,qBACE,8OAAC,uKAAI;QACH,MAAM,KAAK,IAAI;QACf,SAAS;QACT,gBAAc,SAAS,SAAS;QAChC,WAAW,IAAA,gJAAI,EACb,4JACA,YAAY,uBAAuB,aACnC,SAEI,sKACA;;0BAIN,8OAAC;gBACC,MAAM;gBACN,WAAW,IAAA,gJAAI,EACb,wBACA,SAAS,iBAAiB;gBAE5B,aAAW;;;;;;YAIZ,CAAC,2BAAa,8OAAC;gBAAK,WAAU;0BAAW,KAAK,KAAK;;;;;;YAGnD,2BACC,8OAAC;gBACC,WAAW,IAAA,gJAAI,EACb,wEACA,uDACA,kFACA;gBAEF,MAAK;0BAEJ,KAAK,KAAK;;;;;;;;;;;;AAKrB","debugId":null}},
    {"offset": {"line": 353, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/I18nProvider.tsx"],"sourcesContent":["// src/components/I18nProvider.tsx\r\n\"use client\";\r\n\r\nimport React, { createContext, useContext, useEffect, useMemo, useState } from \"react\";\r\n\r\n/**\r\n * Dicion√°rios simples. Mantive pt-BR como padr√£o.\r\n * Se quiser, pode preencher/enxugar o en-US ‚Äî o app vai cair no pt-BR quando faltar chave.\r\n */\r\ntype Dict = Record<string, string | ((vars?: Record<string, any>) => string)>;\r\n\r\nconst ptBR: Dict = {\r\n  // Globais / Header / Sidebar\r\n  welcome: ({ name }: any) => (name ? `Bem-vindo, ${name}` : \"Bem-vindo\"),\r\n  myPanel: \"Meu Painel\",\r\n  ranking: \"Ranking\",\r\n  settings: \"Configura√ß√µes\",\r\n  admin: \"Admin\",\r\n  refresh: \"Atualizar\",\r\n  prev: \"Anterior\",\r\n  next: \"Pr√≥xima\",\r\n  signOut: \"Sair\",\r\n\r\n  // P√°gina /me\r\n  yourPoints: \"Seus pontos:\",\r\n  creatingExample: \"Criando exemplo...\",\r\n  createExample: \"Criar dados de exemplo\",\r\n  weeklyGoalLabel: ({ done, goal }: any) => `Meta semanal (seg‚Äìdom): ${done}/${goal} m√≥dulos`,\r\n  saveGoal: \"Salvar meta\",\r\n  generalProgress: \"Progresso geral\",\r\n  modulesCompleted: ({ done, total }: any) => `${done}/${total} m√≥dulos conclu√≠dos`,\r\n  loadingCoursesModules: \"Carregando cursos e m√≥dulos...\",\r\n  noActiveCourses: \"Nenhum curso ativo. Use ‚ÄúCriar dados de exemplo‚Äù.\",\r\n  donePlusPoints: \"Conclu√≠do (+10 pts)\",\r\n  pending: \"Pendente\",\r\n  updating: \"Atualizando...\",\r\n  undo: \"Desfazer\",\r\n  conclude: \"Concluir\",\r\n\r\n  // Admin / Cursos\r\n  adminCoursesTitle: \"Admin ‚Ä¢ Cursos & M√≥dulos\",\r\n  adminCoursesSubtitle:\r\n    \"Crie cursos, adicione m√≥dulos, ative/desative e edite t√≠tulos. Somente administradores podem alterar.\",\r\n  demoMode: \"Modo Demo\",\r\n  demoModeDesc: \"Popula v√°rios cursos e m√≥dulos de exemplo.\",\r\n  populating: \"Populando...\",\r\n  populateDemo: \"Popular demo\",\r\n  newCourse: \"Novo curso\",\r\n  courseTitlePlaceholder: \"T√≠tulo do curso\",\r\n  courseDescPlaceholder: \"Descri√ß√£o (opcional)\",\r\n  creating: \"Criando...\",\r\n  createCourse: \"Criar curso\",\r\n  titleLabel: \"T√≠tulo\",\r\n  disable: \"Desativar\",\r\n  enable: \"Ativar\",\r\n  delete: \"Excluir\",\r\n  modulePlaceholder: \"Novo m√≥dulo...\",\r\n  addModule: \"Adicionar m√≥dulo\",\r\n  adding: \"Adicionando...\",\r\n  moduleLabel: \"M√≥dulo\",\r\n  save: \"Salvar\",\r\n  cancel: \"Cancelar\",\r\n  edit: \"Editar\",\r\n  loading: \"Carregando...\",\r\n  noCourses: \"Nenhum curso. Crie um acima.\",\r\n\r\n  // Ranking\r\n  position: \"Posi√ß√£o\",\r\n  user: \"Usu√°rio\",\r\n  points: \"Pontos\",\r\n  loadingRanking: \"Carregando ranking...\",\r\n  noDataYet: \"Sem dados ainda.\",\r\n  paginationSummary: ({ total, page, pages }: any) => `${total} usu√°rios ‚Ä¢ p√°gina ${page} de ${pages}`,\r\n};\r\n\r\nconst enUS: Dict = {\r\n  // (opcional, serve como fallback para quando voc√™ selecionar \"en-US\" no futuro)\r\n  welcome: ({ name }: any) => (name ? `Welcome, ${name}` : \"Welcome\"),\r\n  myPanel: \"My Panel\",\r\n  ranking: \"Ranking\",\r\n  settings: \"Settings\",\r\n  admin: \"Admin\",\r\n  refresh: \"Refresh\",\r\n  prev: \"Previous\",\r\n  next: \"Next\",\r\n  signOut: \"Sign out\",\r\n};\r\n\r\nexport type Locale = \"pt-BR\" | \"en-US\";\r\n\r\nconst dictionaries: Record<Locale, Dict> = {\r\n  \"pt-BR\": ptBR,\r\n  \"en-US\": enUS,\r\n};\r\n\r\ntype I18nCtxType = {\r\n  locale: Locale;\r\n  setLocale: (l: Locale) => void;\r\n  t: (key: string, vars?: Record<string, any>) => string;\r\n};\r\n\r\nconst I18nCtx = createContext<I18nCtxType | null>(null);\r\n\r\nexport function I18nProvider({ children }: { children: React.ReactNode }) {\r\n  // Se n√£o for usar troca de idioma agora, deixe fixo em 'pt-BR'\r\n  const [locale, setLocaleState] = useState<Locale>(\"pt-BR\");\r\n\r\n  // Mant√©m o atributo lang coerente (n√£o √© obrigat√≥rio, mas ajuda em SEO/acessibilidade)\r\n  useEffect(() => {\r\n    document.documentElement.setAttribute(\"lang\", locale);\r\n  }, [locale]);\r\n\r\n  // Exponho setLocale para compatibilidade futura (hoje pode ficar sem uso)\r\n  const setLocale = (l: Locale) => {\r\n    setLocaleState(l);\r\n  };\r\n\r\n  // Tradutor com fallback para pt-BR e, por fim, a pr√≥pria chave\r\n  const t = useMemo(() => {\r\n    return (key: string, vars?: Record<string, any>) => {\r\n      const dict = dictionaries[locale] || ptBR;\r\n      const entry = dict[key];\r\n      if (typeof entry === \"function\") return (entry as any)(vars || {});\r\n      if (typeof entry === \"string\") return entry;\r\n\r\n      const fb = ptBR[key];\r\n      if (typeof fb === \"function\") return (fb as any)(vars || {});\r\n      if (typeof fb === \"string\") return fb;\r\n\r\n      return key;\r\n    };\r\n  }, [locale]);\r\n\r\n  const value = useMemo(() => ({ locale, setLocale, t }), [locale, t]);\r\n\r\n  return <I18nCtx.Provider value={value}>{children}</I18nCtx.Provider>;\r\n}\r\n\r\nexport function useI18n() {\r\n  const ctx = useContext(I18nCtx);\r\n  if (!ctx) throw new Error(\"useI18n must be used within I18nProvider\");\r\n  return ctx;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 495, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/shell/AppShell.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { ReactNode, useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport Sidebar from \"@/components/Sidebar\";\r\nimport { Menu, LogOut, Shield } from \"lucide-react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { I18nProvider } from \"@/components/I18nProvider\";\r\n\r\nexport default function AppShell({ children }: { children: ReactNode }) {\r\n  const [open, setOpen] = useState(true);              // desktop: expandida (true) / rail (false)\r\n  const [mobileOpen, setMobileOpen] = useState(false); // mobile drawer\r\n  const [displayName, setDisplayName] = useState<string | null>(null);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const supabase = supabaseBrowser();\r\n    supabase.auth.getUser().then(async ({ data }) => {\r\n      const u = data.user;\r\n      if (u) {\r\n        const { data: prof } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"is_admin, full_name, name\")\r\n          .eq(\"id\", u.id)\r\n          .single();\r\n\r\n        setIsAdmin(!!prof?.is_admin);\r\n        const name =\r\n          (prof?.full_name && String(prof.full_name).trim()) ||\r\n          (prof?.name && String(prof.name).trim()) ||\r\n          u.email ||\r\n          null;\r\n        setDisplayName(name);\r\n      } else {\r\n        setIsAdmin(false);\r\n        setDisplayName(null);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  async function signOut() {\r\n    const supabase = supabaseBrowser();\r\n    await supabase.auth.signOut();\r\n    router.replace(\"/login\");\r\n  }\r\n\r\n  function handleNavigate() {\r\n    setMobileOpen(false);\r\n  }\r\n\r\n  // Largura da 1¬™ coluna no desktop: 18rem (aberta) / 4rem (rail colapsada)\r\n  const desktopCol = open ? \"18rem\" : \"4rem\";\r\n\r\n  return (\r\n    <I18nProvider>\r\n      <div\r\n        className=\"min-h-screen w-full grid\"\r\n        style={{ gridTemplateColumns: `${desktopCol} 1fr` }}\r\n      >\r\n        {/* Sidebar Desktop */}\r\n        <div className=\"hidden lg:block border-r border-white/10 bg-[var(--surface)]/70 backdrop-blur-xl\">\r\n          <Sidebar isAdmin={isAdmin} collapsed={!open} />\r\n        </div>\r\n\r\n        {/* Conte√∫do */}\r\n        <div className=\"min-h-screen flex flex-col\">\r\n          {/* Topbar */}\r\n          <header className=\"sticky top-0 z-30 h-14 border-b border-white/10 bg-[var(--surface)]/70 backdrop-blur flex items-center justify-between px-3 sm:px-4 lg:px-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              {/* Toggle Mobile Drawer */}\r\n              <button\r\n                className=\"btn-icon lg:hidden\"\r\n                onClick={() => setMobileOpen(true)}\r\n                aria-label=\"Abrir menu\"\r\n              >\r\n                <Menu size={18} />\r\n              </button>\r\n\r\n              {/* Toggle largura sidebar (desktop) */}\r\n              <button\r\n                className=\"btn-icon hidden lg:inline-flex\"\r\n                onClick={() => setOpen((v) => !v)}\r\n                aria-label={open ? \"Recolher menu\" : \"Expandir menu\"}\r\n                title={open ? \"Recolher menu\" : \"Expandir menu\"}\r\n              >\r\n                <Menu size={18} />\r\n              </button>\r\n\r\n              <span className=\"text-sm opacity-80 hidden sm:block\">\r\n                {displayName ? `Bem-vindo, ${displayName}` : \"Bem-vindo\"}\r\n              </span>\r\n            </div>\r\n\r\n            {/* A√ß√µes √† direita */}\r\n            <div className=\"flex items-center gap-2\">\r\n              <Link href=\"/me/security\" className=\"btn btn-outline\" title=\"Seguran√ßa da conta\">\r\n                <Shield size={16} />\r\n                <span className=\"hidden sm:inline\">Seguran√ßa</span>\r\n              </Link>\r\n\r\n              <button onClick={signOut} className=\"btn btn-outline\" title=\"Sair\">\r\n                <LogOut size={16} />\r\n                <span className=\"hidden sm:inline\">Sair</span>\r\n              </button>\r\n            </div>\r\n          </header>\r\n\r\n          <main className=\"flex-1 p-4 sm:p-6 lg:p-8\">{children}</main>\r\n        </div>\r\n\r\n        {/* Drawer Mobile */}\r\n        {mobileOpen && (\r\n          <div className=\"lg:hidden fixed inset-0 z-40\">\r\n            {/* overlay */}\r\n            <button\r\n              className=\"absolute inset-0 bg-black/50\"\r\n              onClick={() => setMobileOpen(false)}\r\n              aria-label=\"Fechar menu\"\r\n            />\r\n            <div className=\"absolute left-0 top-0 h-full w-72 bg-[var(--surface)]/90 border-r border-white/10 shadow-xl\">\r\n              <Sidebar isAdmin={isAdmin} onNavigate={handleNavigate} />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </I18nProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 757, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/ui/Spinner.tsx"],"sourcesContent":["// src/components/ui/Spinner.tsx\r\nexport default function Spinner({ label }: { label?: string }) {\r\n  return (\r\n    <div className=\"inline-flex items-center gap-2\" role=\"status\" aria-live=\"polite\">\r\n      <svg\r\n        className=\"animate-spin h-4 w-4\"\r\n        viewBox=\"0 0 24 24\"\r\n        aria-hidden=\"true\"\r\n      >\r\n        <circle\r\n          className=\"opacity-25\"\r\n          cx=\"12\"\r\n          cy=\"12\"\r\n          r=\"10\"\r\n          stroke=\"currentColor\"\r\n          strokeWidth=\"4\"\r\n          fill=\"none\"\r\n        />\r\n        <path\r\n          className=\"opacity-75\"\r\n          d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"\r\n          fill=\"currentColor\"\r\n        />\r\n      </svg>\r\n      {label && <span>{label}</span>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;AACjB,SAAS,QAAQ,EAAE,KAAK,EAAsB;IAC3D,qBACE,8OAAC;QAAI,WAAU;QAAiC,MAAK;QAAS,aAAU;;0BACtE,8OAAC;gBACC,WAAU;gBACV,SAAQ;gBACR,eAAY;;kCAEZ,8OAAC;wBACC,WAAU;wBACV,IAAG;wBACH,IAAG;wBACH,GAAE;wBACF,QAAO;wBACP,aAAY;wBACZ,MAAK;;;;;;kCAEP,8OAAC;wBACC,WAAU;wBACV,GAAE;wBACF,MAAK;;;;;;;;;;;;YAGR,uBAAS,8OAAC;0BAAM;;;;;;;;;;;;AAGvB","debugId":null}},
    {"offset": {"line": 821, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/AuthGuard.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport Spinner from \"@/components/ui/Spinner\";\r\n\r\nexport default function AuthGuard({ children }: { children: React.ReactNode }) {\r\n  const [ready, setReady] = useState(false);\r\n  const [authed, setAuthed] = useState<boolean | null>(null);\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    (async () => {\r\n      const supabase = supabaseBrowser();\r\n      const { data } = await supabase.auth.getSession();\r\n      if (!isMounted) return;\r\n      setAuthed(!!data.session);\r\n      setReady(true);\r\n      if (!data.session) {\r\n        // sem sess√£o => manda pro login\r\n        window.location.replace(\"/login\");\r\n      }\r\n    })();\r\n    return () => { isMounted = false; };\r\n  }, []);\r\n\r\n  if (!ready) {\r\n    return (\r\n      <div className=\"min-h-[40vh] grid place-items-center\">\r\n        <Spinner label=\"Verificando sess√£o...\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return authed ? <>{children}</> : null;\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS,UAAU,EAAE,QAAQ,EAAiC;IAC3E,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAiB;IAErD,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY;QAChB,CAAC;YACC,MAAM,WAAW,IAAA,mJAAe;YAChC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;YAC/C,IAAI,CAAC,WAAW;YAChB,UAAU,CAAC,CAAC,KAAK,OAAO;YACxB,SAAS;YACT,IAAI,CAAC,KAAK,OAAO,EAAE;gBACjB,gCAAgC;gBAChC,OAAO,QAAQ,CAAC,OAAO,CAAC;YAC1B;QACF,CAAC;QACD,OAAO;YAAQ,YAAY;QAAO;IACpC,GAAG,EAAE;IAEL,IAAI,CAAC,OAAO;QACV,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,8IAAO;gBAAC,OAAM;;;;;;;;;;;IAGrB;IAEA,OAAO,uBAAS;kBAAG;wBAAe;AACpC","debugId":null}},
    {"offset": {"line": 884, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/chat/ChatDock.tsx"],"sourcesContent":["// src/components/chat/ChatDock.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { SendHorizontal, MessageSquareText, Paperclip } from \"lucide-react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\n/** Estrutura esperada da tabela `public.messages`\r\n *  - id: uuid (pk, default gen_random_uuid())\r\n *  - user_id: uuid (fk -> auth.users.id)\r\n *  - channel: text\r\n *  - content: text\r\n *  - created_at: timestamptz default now()\r\n *  - client_msg_id: uuid (opcional ‚Äì para deduplica√ß√£o)\r\n */\r\ntype DbMessage = {\r\n  id: string;\r\n  user_id: string | null;\r\n  channel: string;\r\n  content: string;\r\n  created_at: string;\r\n  client_msg_id?: string | null;\r\n};\r\n\r\ntype Profile = {\r\n  id: string;\r\n  full_name: string | null;\r\n  name?: string | null;\r\n};\r\n\r\ntype Props = {\r\n  /** Canal de chat. Ex.: \"ranking-global\" */\r\n  channel: string;\r\n  /** Altura m√≠nima (opcional) */\r\n  minHeight?: number;\r\n};\r\n\r\nexport default function ChatDock({ channel, minHeight = 520 }: Props) {\r\n  const supabase = useMemo(() => supabaseBrowser(), []);\r\n  const [me, setMe] = useState<string | null>(null);\r\n  const [text, setText] = useState(\"\");\r\n  const [sending, setSending] = useState(false);\r\n\r\n  const [messages, setMessages] = useState<DbMessage[]>([]);\r\n  const [names, setNames] = useState<Record<string, string>>({});\r\n\r\n  // conjuntos para deduplica√ß√£o (id do row e id do cliente)\r\n  const seenIds = useRef<Set<string>>(new Set());\r\n  const seenClientIds = useRef<Set<string>>(new Set());\r\n\r\n  const listRef = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // formatador de hora (HH:mm)\r\n  const fmt = useMemo(\r\n    () =>\r\n      new Intl.DateTimeFormat(undefined, {\r\n        hour: \"2-digit\",\r\n        minute: \"2-digit\",\r\n      }),\r\n    []\r\n  );\r\n\r\n  /* ---------------------- Carga inicial ---------------------- */\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    (async () => {\r\n      const { data: u } = await supabase.auth.getUser();\r\n      const uid = u.user?.id ?? null;\r\n      if (!cancelled) setMe(uid);\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"messages\")\r\n        .select(\"*\")\r\n        .eq(\"channel\", channel)\r\n        .order(\"created_at\", { ascending: true })\r\n        .limit(200);\r\n\r\n      if (error) {\r\n        // opcional: tratar erro visualmente\r\n        return;\r\n      }\r\n\r\n      const list = (data as DbMessage[]) || [];\r\n\r\n      // popular caches de deduplica√ß√£o\r\n      for (const m of list) {\r\n        if (m.id) seenIds.current.add(String(m.id));\r\n        if (m.client_msg_id) seenClientIds.current.add(String(m.client_msg_id));\r\n      }\r\n\r\n      if (!cancelled) {\r\n        setMessages(list);\r\n\r\n        // Prefetch nomes de perfis\r\n        const ids = Array.from(new Set(list.map((m) => m.user_id).filter(Boolean))) as string[];\r\n        if (ids.length) {\r\n          const { data: profs } = await supabase\r\n            .from(\"profiles\")\r\n            .select(\"id, full_name, name\")\r\n            .in(\"id\", ids);\r\n\r\n          const map: Record<string, string> = {};\r\n          (profs as Profile[] | null)?.forEach((p) => {\r\n            map[p.id] =\r\n              (p.full_name && p.full_name.trim()) ||\r\n              (p.name && p.name.trim()) ||\r\n              \"Usu√°rio\";\r\n          });\r\n          setNames(map);\r\n        }\r\n\r\n        // foca input na primeira carga\r\n        setTimeout(() => inputRef.current?.focus(), 60);\r\n        // scroll para o fim\r\n        setTimeout(() => {\r\n          listRef.current?.scrollTo({\r\n            top: listRef.current.scrollHeight,\r\n            behavior: \"auto\",\r\n          });\r\n        }, 0);\r\n      }\r\n    })();\r\n\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [channel, supabase]);\r\n\r\n  /* ---------------------- Realtime (INSERT) ---------------------- */\r\n  useEffect(() => {\r\n    const ch = supabase\r\n      .channel(`chat:${channel}`)\r\n      .on(\r\n        \"postgres_changes\",\r\n        {\r\n          event: \"INSERT\",\r\n          schema: \"public\",\r\n          table: \"messages\",\r\n          filter: `channel=eq.${channel}`,\r\n        },\r\n        async (payload) => {\r\n          const m = payload.new as DbMessage;\r\n\r\n          // dedupe: ignora se j√° vimos\r\n          if (m?.id && seenIds.current.has(String(m.id))) return;\r\n          if (m?.client_msg_id && seenClientIds.current.has(String(m.client_msg_id))) return;\r\n\r\n          if (m?.id) seenIds.current.add(String(m.id));\r\n          if (m?.client_msg_id) seenClientIds.current.add(String(m.client_msg_id));\r\n\r\n          setMessages((cur) => [...cur, m]);\r\n\r\n          // busca nome se ainda n√£o temos cache\r\n          if (m.user_id && !names[m.user_id]) {\r\n            const { data: p } = await supabase\r\n              .from(\"profiles\")\r\n              .select(\"id, full_name, name\")\r\n              .eq(\"id\", m.user_id)\r\n              .single();\r\n            if (p) {\r\n              setNames((old) => ({\r\n                ...old,\r\n                [p.id]:\r\n                  (p.full_name && p.full_name.trim()) ||\r\n                  (p.name && p.name.trim()) ||\r\n                  \"Usu√°rio\",\r\n              }));\r\n            }\r\n          }\r\n\r\n          // autoscroll: se est√° perto do fim ou se a msg √© minha\r\n          const el = listRef.current;\r\n          if (!el) return;\r\n          const nearBottom = el.scrollHeight - el.scrollTop - el.clientHeight < 120;\r\n          if (nearBottom || (m.user_id && m.user_id === me)) {\r\n            setTimeout(() => {\r\n              listRef.current?.scrollTo({\r\n                top: listRef.current.scrollHeight,\r\n                behavior: \"smooth\",\r\n              });\r\n            }, 0);\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(ch);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [channel, supabase, me, names]);\r\n\r\n  /* ---------------------- Auto scroll no append ---------------------- */\r\n  useEffect(() => {\r\n    listRef.current?.scrollTo({\r\n      top: listRef.current.scrollHeight,\r\n      behavior: \"smooth\",\r\n    });\r\n  }, [messages.length]);\r\n\r\n  /* ---------------------- Envio ---------------------- */\r\n  async function send() {\r\n    const content = text.trim();\r\n    if (!content || !me) return;\r\n    if (content.length > 800) return; // prote√ß√£o simples\r\n\r\n    setSending(true);\r\n    const clientId = uuidv4();\r\n    try {\r\n      setText(\"\");\r\n\r\n      // Insere e j√° pede o row para eco imediato (sem duplicar)\r\n      const { data, error } = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n          user_id: me,\r\n          channel,\r\n          content,\r\n          client_msg_id: clientId,\r\n        })\r\n        .select(\"*\")\r\n        .single();\r\n\r\n      if (error) {\r\n        // devolve texto se falhar\r\n        setText(content);\r\n        return;\r\n      }\r\n\r\n      // marca como visto para o realtime n√£o duplicar\r\n      if (data?.id) seenIds.current.add(String(data.id));\r\n      if (clientId) seenClientIds.current.add(clientId);\r\n\r\n      const row = data as DbMessage;\r\n      setMessages((cur) => [...cur, row]);\r\n      setTimeout(() => {\r\n        listRef.current?.scrollTo({\r\n          top: listRef.current.scrollHeight,\r\n          behavior: \"smooth\",\r\n        });\r\n      }, 0);\r\n    } finally {\r\n      setSending(false);\r\n      setTimeout(() => inputRef.current?.focus(), 10);\r\n    }\r\n  }\r\n\r\n  function onKeyDown(e: React.KeyboardEvent<HTMLInputElement>) {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      if (!sending) send();\r\n    }\r\n  }\r\n\r\n  /* ---------------------- Render ---------------------- */\r\n  return (\r\n    <div\r\n      className=\"rounded-2xl border border-white/10 bg-[var(--surface)]/70 backdrop-blur-md shadow-xl overflow-hidden flex flex-col\"\r\n      style={{ minHeight }}\r\n      aria-label=\"Chat do Ranking\"\r\n    >\r\n      {/* Header */}\r\n      <div className=\"h-11 px-3 flex items-center justify-between border-b border-white/10\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"inline-flex w-2 h-2 rounded-full bg-[var(--accent)] animate-pulse\" />\r\n          <span className=\"font-medium text-sm\">Chat do Ranking</span>\r\n        </div>\r\n        <div className=\"text-[11px] opacity-70 flex items-center gap-1\">\r\n          <MessageSquareText size={14} aria-hidden=\"true\" />\r\n          {messages.length}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Lista de mensagens */}\r\n      <div\r\n        ref={listRef}\r\n        className=\"flex-1 overflow-y-auto p-3 space-y-1.5\"\r\n        role=\"log\"\r\n        aria-live=\"polite\"\r\n        aria-relevant=\"additions\"\r\n      >\r\n        {messages.map((m, i) => {\r\n          const mine = m.user_id === me;\r\n          const name =\r\n            (m.user_id && names[m.user_id]) ||\r\n            (mine ? \"Voc√™\" : m.user_id ? `Usu√°rio ${m.user_id.slice(0, 4)}` : \"Usu√°rio\");\r\n          const prev = messages[i - 1];\r\n          const sameAsPrev = prev && prev.user_id === m.user_id;\r\n          const time = fmt.format(new Date(m.created_at));\r\n\r\n          return (\r\n            <div key={m.id} className={`flex ${mine ? \"justify-end\" : \"justify-start\"}`}>\r\n              {/* avatar pequeno para outros (apenas se autor mudou) */}\r\n              {!mine && !sameAsPrev && (\r\n                <div className=\"mr-2 mt-5 flex-shrink-0\">\r\n                  <div className=\"w-6 h-6 rounded-full bg-white/10 grid place-items-center text-[11px]\">\r\n                    {name?.[0]?.toUpperCase() || \"U\"}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* container da mensagem + hora */}\r\n              <div className=\"max-w-full flex flex-col items-start\">\r\n                {!mine && !sameAsPrev && (\r\n                  <div className=\"text-[11px] font-medium mb-1 ml-1 opacity-60\">{name}</div>\r\n                )}\r\n\r\n                <div\r\n                  className={[\r\n                    \"max-w-[100%] md:max-w-[100%]\",\r\n                    \"px-3 py-1.5 rounded-2xl text-[13px] leading-snug\",\r\n                    \"shadow-[0_1px_3px_rgba(0,0,0,0.25)]\",\r\n                    mine\r\n                      ? \"self-end bg-gradient-to-r from-[#A3E635]/90 to-[#84CC16]/80 text-black rounded-br-sm\"\r\n                      : \"self-start bg-gradient-to-r from-white/10 to-white/5 text-white rounded-bl-sm\",\r\n                  ].join(\" \")}\r\n                >\r\n                  <div className=\"whitespace-pre-line break-words\">{m.content}</div>\r\n                </div>\r\n\r\n                <div\r\n                  className={`text-[10px] mt-[2px] ${\r\n                    mine ? \"self-end pr-1 text-white/40\" : \"self-start pl-1 text-white/40\"\r\n                  }`}\r\n                >\r\n                  {time}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n\r\n        {messages.length === 0 && (\r\n          <div className=\"h-full w-full grid place-items-center text-sm opacity-70\">\r\n            Nenhuma mensagem ainda ‚Äî diga um oi üëã\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Composer */}\r\n      <div className=\"h-14 border-t border-white/10 px-2 sm:px-3 flex items-center gap-2\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"w-9 h-9 rounded-full bg-white/5 border border-white/10 grid place-items-center\"\r\n          title=\"Anexar (futuro)\"\r\n        >\r\n          <Paperclip size={16} className=\"opacity-80\" />\r\n        </button>\r\n\r\n        <input\r\n          ref={inputRef}\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n          onKeyDown={onKeyDown}\r\n          placeholder=\"Escreva uma mensagem‚Ä¶\"\r\n          className=\"flex-1 h-9 px-3 rounded-full bg-white/5 border border-white/10 outline-none focus:ring-2 focus:ring-white/20 text-[13px] placeholder:opacity-60\"\r\n          maxLength={800}\r\n          aria-label=\"Escreva uma mensagem\"\r\n        />\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={send}\r\n          disabled={!text.trim() || sending}\r\n          className=\"h-9 min-w-[84px] inline-flex items-center justify-center gap-2 rounded-full px-3 bg-white/10 hover:bg-white/20 disabled:opacity-60 transition\"\r\n        >\r\n          <SendHorizontal size={16} aria-hidden=\"true\" />\r\n          <span className=\"text-sm\">Enviar</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1305, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/app/ranking/page.tsx"],"sourcesContent":["// src/app/ranking/page.tsx\r\n\"use client\";\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport Card from \"@/components/ui/Card\";\r\nimport MotionButton from \"@/components/ui/MotionButton\";\r\nimport AppShell from \"@/components/shell/AppShell\";\r\nimport AuthGuard from \"@/components/AuthGuard\";\r\nimport ChatDock from \"@/components/chat/ChatDock\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Trophy, Crown } from \"lucide-react\";\r\n\r\ntype Row = { user_id: string; email: string; total: number };\r\n\r\n/* --------------------------- Helpers UI --------------------------- */\r\nfunction initialsFrom(nameOrEmail: string) {\r\n  const s = (nameOrEmail || \"\").trim();\r\n  if (!s) return \"U\";\r\n  const parts = s.replace(/@.*/, \"\").split(/\\s+/).filter(Boolean);\r\n  const a = parts[0]?.[0] ?? \"\";\r\n  const b = parts.length > 1 ? parts[parts.length - 1][0] ?? \"\" : (parts[0]?.[1] ?? \"\");\r\n  return (a + b).toUpperCase();\r\n}\r\n\r\nfunction RankBadge({ rank }: { rank: number }) {\r\n  const base =\r\n    \"inline-flex items-center justify-center w-7 h-7 rounded-full text-[13px] font-bold select-none\";\r\n  if (rank === 1)\r\n    return (\r\n      <span className={`${base} bg-lime-400/20 text-lime-300 drop-shadow-[0_0_6px_rgba(163,230,53,0.35)]`}>\r\n        1\r\n      </span>\r\n    );\r\n  if (rank === 2) return <span className={`${base} bg-indigo-400/20 text-indigo-300`}>2</span>;\r\n  if (rank === 3) return <span className={`${base} bg-amber-400/20 text-amber-300`}>3</span>;\r\n  return <span className={`${base} bg-white/10 text-white/70`}>{rank}</span>;\r\n}\r\n\r\nfunction AnimatedPoints({ value }: { value: number | null | undefined }) {\r\n  const v = Number.isFinite(Number(value)) ? Number(value) : 0;\r\n  const useGradient = v > 0;\r\n\r\n  return (\r\n    <motion.span\r\n      initial={{ y: 6, opacity: 0 }}\r\n      animate={{ y: 0, opacity: 1 }}\r\n      transition={{ duration: 0.18 }}\r\n      className={\r\n        \"font-semibold text-right \" +\r\n        (useGradient\r\n          ? \"bg-gradient-to-r from-lime-400 via-green-300 to-indigo-400 bg-clip-text text-transparent\"\r\n          : \"text-white/90\")\r\n      }\r\n      style={\r\n        useGradient\r\n          ? { WebkitBackgroundClip: \"text\", WebkitTextFillColor: \"transparent\" }\r\n          : undefined\r\n      }\r\n    >\r\n      {v.toLocaleString(\"pt-BR\")}\r\n    </motion.span>\r\n  );\r\n}\r\n\r\n/* ------------------------ Skeleton Components ------------------------ */\r\nfunction SkeletonRow() {\r\n  return (\r\n    <div className=\"grid grid-cols-[88px_1fr_160px] md:grid-cols-[120px_1fr_180px] items-center px-4 py-3\">\r\n      {/* posi√ß√£o + medalha */}\r\n      <div className=\"flex items-center gap-2\">\r\n        <div className=\"w-7 h-7 rounded-full bg-white/10 animate-pulse\" />\r\n        <div className=\"w-4 h-4 rounded bg-white/10 animate-pulse\" />\r\n      </div>\r\n      {/* usu√°rio (avatar + nome) */}\r\n      <div className=\"flex items-center gap-3 min-w-0\">\r\n        <div className=\"w-8 h-8 rounded-full bg-white/10 border border-white/10 animate-pulse\" />\r\n        <div className=\"flex-1 min-w-0\">\r\n          <div className=\"h-3 w-40 max-w-[60%] bg-white/10 rounded animate-pulse\" />\r\n          <div className=\"mt-1 h-2 w-16 bg-white/5 rounded animate-pulse\" />\r\n        </div>\r\n      </div>\r\n      {/* pontos */}\r\n      <div className=\"flex justify-end\">\r\n        <div className=\"h-3 w-16 bg-white/10 rounded animate-pulse\" />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SkeletonRows({ count = 6 }: { count?: number }) {\r\n  return (\r\n    <div className=\"divide-y divide-white/10\">\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <SkeletonRow key={i} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------------- Page ------------------------------ */\r\nexport default function RankingPage() {\r\n  const [rows, setRows] = useState<Row[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [err, setErr] = useState<string | null>(null);\r\n\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(25);\r\n  const [pages, setPages] = useState(1);\r\n  const [total, setTotal] = useState(0);\r\n\r\n  const [names, setNames] = useState<Record<string, string>>({});\r\n  const [currentUserId, setCurrentUserId] = useState<string | null>(null);\r\n\r\n  const supabase = useMemo(() => supabaseBrowser(), []);\r\n  const abortRef = useRef<AbortController | null>(null);\r\n  const sentinelRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  async function load(p = 1, { append = false } = {}) {\r\n    abortRef.current?.abort();\r\n    const ctrl = new AbortController();\r\n    abortRef.current = ctrl;\r\n\r\n    try {\r\n      setErr(null);\r\n      setLoading(true);\r\n\r\n      // usu√°rio atual\r\n      const { data: auth } = await supabase.auth.getUser();\r\n      setCurrentUserId(auth.user?.id ?? null);\r\n\r\n      const res = await fetch(`/api/ranking?page=${p}&pageSize=${pageSize}`, {\r\n        cache: \"no-store\",\r\n        signal: ctrl.signal,\r\n      });\r\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n      const json = await res.json();\r\n\r\n      const list: Row[] = (json.leaderboard ?? []).map((r: any) => ({\r\n        user_id: r.user_id,\r\n        email: r.email,\r\n        total: Number(r.total ?? r.points ?? r.sum ?? 0), // normaliza\r\n      }));\r\n\r\n      setPages(json.pages ?? 1);\r\n      setTotal(json.total ?? list.length);\r\n      setRows((prev) => (append ? [...prev, ...list] : list));\r\n      setPage(p);\r\n\r\n      // nomes\r\n      const ids = list.map((r) => r.user_id).filter(Boolean);\r\n      if (ids.length) {\r\n        const { data: prof } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id, full_name, name\")\r\n          .in(\"id\", ids);\r\n\r\n        const map: Record<string, string> = {};\r\n        (prof ?? []).forEach((p: any) => {\r\n          const disp =\r\n            (p.full_name && String(p.full_name).trim()) ||\r\n            (p.name && String(p.name).trim()) ||\r\n            \"\";\r\n          if (disp) map[p.id] = disp;\r\n        });\r\n        setNames((prev) => ({ ...prev, ...map }));\r\n      }\r\n    } catch (e: any) {\r\n      if (e.name !== \"AbortError\") setErr(e.message ?? \"Falha ao carregar ranking.\");\r\n    } finally {\r\n      if (!ctrl.signal.aborted) setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    load(1);\r\n    const channel = supabase\r\n      .channel(\"ranking-progress\")\r\n      .on(\r\n        \"postgres_changes\",\r\n        { event: \"*\", schema: \"public\", table: \"progress\" },\r\n        () => load(1)\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n      abortRef.current?.abort();\r\n    };\r\n  }, [supabase, pageSize]);\r\n\r\n  // Auto-load ao chegar no fim (scroll infinito)\r\n  useEffect(() => {\r\n    if (!sentinelRef.current) return;\r\n    const el = sentinelRef.current;\r\n\r\n    const obs = new IntersectionObserver(\r\n      (entries) => {\r\n        const first = entries[0];\r\n        if (first.isIntersecting && page < pages && !loading && !err) {\r\n          load(page + 1, { append: true });\r\n        }\r\n      },\r\n      { rootMargin: \"200px\" }\r\n    );\r\n\r\n    obs.observe(el);\r\n    return () => obs.disconnect();\r\n  }, [page, pages, loading, err]);\r\n\r\n  const isInitialLoading = loading && rows.length === 0;\r\n  const isAppending = loading && rows.length > 0;\r\n\r\n  return (\r\n    <AuthGuard>\r\n      <AppShell>\r\n        <div className=\"max-w-6xl mx-auto px-4 lg:px-6 py-6 lg:py-8\">\r\n          {/* Cabe√ßalho */}\r\n          <div className=\"flex items-center justify-between gap-3\">\r\n            <h1 className=\"text-2xl font-semibold tracking-tight flex items-center gap-2\">\r\n              <span className=\"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 border border-white/10\">\r\n                <Trophy size={18} />\r\n              </span>\r\n              Ranking\r\n            </h1>\r\n            <div className=\"flex gap-2\">\r\n              <MotionButton\r\n                onClick={() => load(1)}\r\n                className=\"px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 transition\"\r\n              >\r\n                Atualizar\r\n              </MotionButton>\r\n              <Link\r\n                href=\"/me\"\r\n                className=\"px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 transition\"\r\n              >\r\n                Meu Painel\r\n              </Link>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Grid: ranking + chat */}\r\n          <div className=\"mt-6 grid grid-cols-1 lg:grid-cols-12 gap-5\">\r\n            {/* Coluna Ranking */}\r\n            <div className=\"lg:col-span-8\">\r\n              <Card className=\"overflow-hidden p-0\">\r\n                {/* Cabe√ßalho tabela */}\r\n                <div className=\"grid grid-cols-[88px_1fr_160px] md:grid-cols-[120px_1fr_180px] items-center px-4 py-3 text-xs uppercase tracking-wider bg-gradient-to-r from-white/10 via-white/5 to-transparent text-white/60\">\r\n                  <span>Posi√ß√£o</span>\r\n                  <span>Usu√°rio</span>\r\n                  <span className=\"text-right\">Pontos</span>\r\n                </div>\r\n\r\n                {/* Linhas */}\r\n                <div className=\"divide-y divide-white/10\">\r\n                  {isInitialLoading ? (\r\n                    <SkeletonRows count={7} />\r\n                  ) : err && rows.length === 0 ? (\r\n                    <div className=\"px-4 py-6 text-center opacity-80\">{err}</div>\r\n                  ) : rows.length === 0 ? (\r\n                    <div className=\"px-4 py-6 text-center opacity-80\">Sem dados ainda.</div>\r\n                  ) : (\r\n                    <>\r\n                      <AnimatePresence initial={false}>\r\n                        {rows.map((r, i) => {\r\n                          const pos = i + 1;\r\n                          const display =\r\n                            (names[r.user_id] && names[r.user_id].trim()) ||\r\n                            r.email ||\r\n                            `User ${r.user_id.slice(0, 4)}`;\r\n                          const isMe = currentUserId && r.user_id === currentUserId;\r\n\r\n                          const rowBg =\r\n                            pos === 1\r\n                              ? \"bg-gradient-to-r from-lime-400/10 to-green-400/10\"\r\n                              : pos === 2\r\n                              ? \"bg-gradient-to-r from-indigo-400/10 to-blue-400/10\"\r\n                              : pos === 3\r\n                              ? \"bg-gradient-to-r from-amber-400/10 to-orange-400/10\"\r\n                              : \"hover:bg-white/5\";\r\n\r\n                          return (\r\n                            <motion.div\r\n                              key={`${r.user_id}-${pos}`}\r\n                              layout\r\n                              initial={{ opacity: 0, y: 6 }}\r\n                              animate={{ opacity: 1, y: 0 }}\r\n                              exit={{ opacity: 0, y: -6 }}\r\n                              transition={{ duration: 0.18 }}\r\n                              className={`grid grid-cols-[88px_1fr_160px] md:grid-cols-[120px_1fr_180px] items-center px-4 py-3 ${rowBg}`}\r\n                            >\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <RankBadge rank={pos} />\r\n                                {pos === 1 && <Crown size={16} className=\"text-lime-300\" />}\r\n                              </div>\r\n\r\n                              <div className=\"flex items-center gap-3 min-w-0\">\r\n                                <div\r\n                                  className={`w-8 h-8 rounded-full border border-white/10 grid place-items-center text-[11px] font-semibold select-none ${\r\n                                    isMe ? \"ring-2 ring-lime-400/40\" : \"\"\r\n                                  } bg-white/10`}\r\n                                >\r\n                                  {initialsFrom(display)}\r\n                                </div>\r\n                                <div className=\"flex flex-col min-w-0\">\r\n                                  <span className={`truncate ${isMe ? \"font-semibold\" : \"\"}`}>\r\n                                    {display}\r\n                                  </span>\r\n                                  {isMe && (\r\n                                    <span className=\"text-[11px] text-lime-300/80\">voc√™</span>\r\n                                  )}\r\n                                </div>\r\n                              </div>\r\n\r\n                              <div className=\"flex justify-end\">\r\n                                <AnimatedPoints value={r.total} />\r\n                              </div>\r\n                            </motion.div>\r\n                          );\r\n                        })}\r\n                      </AnimatePresence>\r\n\r\n                      {/* skeletons de append (carregando pr√≥xima p√°gina) */}\r\n                      {isAppending && <SkeletonRows count={4} />}\r\n                    </>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Rodap√© */}\r\n                <div className=\"px-4 py-3 flex items-center justify-between text-sm\">\r\n                  <div className=\"opacity-80\">\r\n                    Mostrando {rows.length} de {total} usu√°rio{total !== 1 ? \"s\" : \"\"}\r\n                  </div>\r\n                  {page < pages && (\r\n                    <MotionButton\r\n                      onClick={() => load(page + 1, { append: true })}\r\n                      disabled={loading}\r\n                      className=\"px-3 h-9 rounded-xl bg-white/10 hover:bg-white/20 transition disabled:opacity-60\"\r\n                    >\r\n                      {loading ? \"Carregando...\" : \"Carregar mais\"}\r\n                    </MotionButton>\r\n                  )}\r\n                </div>\r\n                <div ref={sentinelRef} className=\"h-2 w-full\" />\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Coluna Chat */}\r\n            <div className=\"lg:col-span-4\">\r\n              <Card className=\"p-0 overflow-hidden bg-white/[0.03] backdrop-blur-xl border-white/10\">\r\n                <div className=\"px-4 py-3 border-b border-white/10 flex items-center justify-between\">\r\n                  <div>\r\n                    <div className=\"text-sm font-semibold\">Chat do Ranking</div>\r\n                    <div className=\"text-xs opacity-70\">Conectado a <code>ranking-global</code></div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-[13px] leading-5\">\r\n                  <ChatDock channel=\"ranking-global\" />\r\n                </div>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </AppShell>\r\n    </AuthGuard>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}