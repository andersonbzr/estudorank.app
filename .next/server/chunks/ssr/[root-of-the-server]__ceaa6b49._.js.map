{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/lib/supabase/client.ts"],"sourcesContent":["// src/lib/supabase/client.ts\r\nimport { createClient, type SupabaseClient } from \"@supabase/supabase-js\";\r\n\r\nlet _client: SupabaseClient | null = null;\r\n\r\n/**\r\n * Cliente do Supabase para uso no browser (componentes client).\r\n * Usa storageKey custom \"sr-auth\" para evitar conflitos e manter sessão.\r\n */\r\nexport function supabaseBrowser(): SupabaseClient {\r\n  if (_client) return _client;\r\n\r\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n  if (!url || !anon) {\r\n    throw new Error(\r\n      \"Env vars ausentes: defina NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\r\n    );\r\n  }\r\n\r\n  _client = createClient(url, anon, {\r\n    auth: {\r\n      persistSession: true,\r\n      autoRefreshToken: true,\r\n      storageKey: \"sr-auth\",\r\n    },\r\n  });\r\n\r\n  return _client;\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;AAC7B;;AAEA,IAAI,UAAiC;AAM9B,SAAS;IACd,IAAI,SAAS,OAAO;IAEpB,MAAM;IACN,MAAM;IAEN;;IAMA,UAAU,IAAA,uMAAY,EAAC,KAAK,MAAM;QAChC,MAAM;YACJ,gBAAgB;YAChB,kBAAkB;YAClB,YAAY;QACd;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/app/ranking/page.tsx"],"sourcesContent":["// src/app/ranking/page.tsx\r\n\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Crown, Medal, Trophy } from \"lucide-react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\n\r\n/* ------------------------- Tipos ------------------------- */\r\ntype Profile = {\r\n  id: string;\r\n  full_name?: string | null;\r\n  name?: string | null;\r\n  avatar_url?: string | null;\r\n  points?: number | null; // ajuste se sua coluna tiver outro nome\r\n};\r\n\r\n/* --------------------- Util / helpers --------------------- */\r\nfunction classNames(...xs: Array<string | false | undefined>) {\r\n  return xs.filter(Boolean).join(\" \");\r\n}\r\n\r\nfunction initials(name?: string | null) {\r\n  if (!name) return \"U\";\r\n  const parts = name.trim().split(/\\s+/);\r\n  return (parts[0]?.[0] ?? \"U\") + (parts[1]?.[0] ?? \"\");\r\n}\r\n\r\nfunction rankDecor(rank: number) {\r\n  // estilos específicos para 1º/2º/3º\r\n  if (rank === 1)\r\n    return {\r\n      row: \"bg-gradient-to-r from-lime-400/10 to-emerald-400/10\",\r\n      badge: \"text-lime-300 drop-shadow-[0_0_8px_rgba(163,230,53,0.45)]\",\r\n      ring: \"ring-2 ring-lime-400/40\",\r\n      icon: <Crown size={18} />,\r\n    };\r\n  if (rank === 2)\r\n    return {\r\n      row: \"bg-gradient-to-r from-indigo-400/10 to-blue-400/10\",\r\n      badge: \"text-indigo-300 drop-shadow-[0_0_8px_rgba(99,102,241,0.45)]\",\r\n      ring: \"ring-2 ring-indigo-400/40\",\r\n      icon: <Medal size={18} />,\r\n    };\r\n  if (rank === 3)\r\n    return {\r\n      row: \"bg-gradient-to-r from-amber-400/10 to-orange-400/10\",\r\n      badge: \"text-amber-300 drop-shadow-[0_0_8px_rgba(245,158,11,0.45)]\",\r\n      ring: \"ring-2 ring-amber-400/40\",\r\n      icon: <Medal size={18} />,\r\n    };\r\n  return {\r\n    row: \"\",\r\n    badge: \"text-white/60\",\r\n    ring: \"ring-0\",\r\n    icon: <Trophy size={16} />,\r\n  };\r\n}\r\n\r\n/* --------------------- Avatar circular -------------------- */\r\nfunction Avatar({ name, url, accentClass }: { name?: string | null; url?: string | null; accentClass?: string }) {\r\n  if (url) {\r\n    return (\r\n      <img\r\n        src={url}\r\n        alt={name ?? \"avatar\"}\r\n        className={classNames(\r\n          \"w-8 h-8 rounded-full object-cover border border-white/10\",\r\n          accentClass\r\n        )}\r\n      />\r\n    );\r\n  }\r\n  return (\r\n    <div\r\n      className={classNames(\r\n        \"w-8 h-8 rounded-full grid place-items-center text-[11px] font-semibold\",\r\n        \"bg-white/10 border border-white/10\",\r\n        accentClass\r\n      )}\r\n    >\r\n      {initials(name)}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------- Componente ----------------------- */\r\nexport default function RankingPage() {\r\n  const [rows, setRows] = useState<Profile[]>([]);\r\n  const [meId, setMeId] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Carrega ranking (profiles ordenado por pontos) + meu ID\r\n  useEffect(() => {\r\n    (async () => {\r\n      const supabase = supabaseBrowser();\r\n\r\n      const me = await supabase.auth.getUser();\r\n      setMeId(me.data.user?.id ?? null);\r\n\r\n      // ajuste os campos conforme seu schema\r\n      const { data } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"id, full_name, name, avatar_url, points\")\r\n        .order(\"points\", { ascending: false, nullsFirst: false })\r\n        .limit(100);\r\n\r\n      setRows((data as Profile[]) ?? []);\r\n      setLoading(false);\r\n    })();\r\n  }, []);\r\n\r\n  const maxPoints = useMemo(\r\n    () => Math.max(1, ...(rows.map(r => r.points ?? 0))),\r\n    [rows]\r\n  );\r\n\r\n  return (\r\n    <main className=\"max-w-3xl mx-auto\">\r\n      {/* Título */}\r\n      <div className=\"flex items-center gap-2 mb-4\">\r\n        <Trophy className=\"text-lime-300\" />\r\n        <h1 className=\"text-2xl font-semibold tracking-tight\">Ranking</h1>\r\n      </div>\r\n\r\n      {/* Card/Tabela */}\r\n      <div className=\"rounded-2xl border border-white/10 overflow-hidden shadow-[0_0_36px_-18px_rgba(163,230,53,0.25)]\">\r\n        {/* Cabeçalho */}\r\n        <div className=\"grid grid-cols-[72px_1fr_120px] items-center px-4 py-3 bg-gradient-to-r from-lime-400/10 via-green-400/5 to-transparent text-xs uppercase tracking-wider text-white/60\">\r\n          <div>Posição</div>\r\n          <div>Usuário</div>\r\n          <div className=\"text-right\">Pontos</div>\r\n        </div>\r\n\r\n        {/* Linhas */}\r\n        <AnimatePresence initial={false}>\r\n          {loading ? (\r\n            Array.from({ length: 5 }).map((_, i) => (\r\n              <motion.div\r\n                key={`skeleton-${i}`}\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                className=\"grid grid-cols-[72px_1fr_120px] items-center px-4 py-3 border-t border-white/5\"\r\n              >\r\n                <div className=\"h-4 w-10 bg-white/10 rounded\" />\r\n                <div className=\"h-4 w-40 bg-white/10 rounded\" />\r\n                <div className=\"h-4 w-16 bg-white/10 rounded justify-self-end\" />\r\n              </motion.div>\r\n            ))\r\n          ) : rows.length === 0 ? (\r\n            <div className=\"px-4 py-6 text-sm opacity-70 border-t border-white/5\">\r\n              Ninguém no ranking ainda. Conclua módulos para começar a pontuar!\r\n            </div>\r\n          ) : (\r\n            rows.map((r, idx) => {\r\n              const rank = idx + 1;\r\n              const name = r.full_name || r.name || \"Usuário\";\r\n              const pts = r.points ?? 0;\r\n              const deco = rankDecor(rank);\r\n              const isMe = meId && r.id === meId;\r\n\r\n              return (\r\n                <motion.div\r\n                  key={r.id}\r\n                  layout\r\n                  initial={{ opacity: 0, y: 6 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  exit={{ opacity: 0, y: -6 }}\r\n                  transition={{ duration: 0.18 }}\r\n                  className={classNames(\r\n                    \"grid grid-cols-[72px_1fr_120px] items-center px-4 py-3 border-t border-white/5\",\r\n                    \"hover:bg-white/5 transition-colors\",\r\n                    deco.row\r\n                  )}\r\n                >\r\n                  {/* Posição + medalha */}\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div\r\n                      className={classNames(\r\n                        \"w-8 h-8 rounded-lg grid place-items-center bg-white/5 border border-white/10\",\r\n                        deco.badge\r\n                      )}\r\n                      title={`Posição ${rank}`}\r\n                    >\r\n                      {rank <= 3 ? deco.icon : <span className=\"text-xs\">{rank}</span>}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Usuário */}\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <Avatar name={name} url={r.avatar_url ?? undefined} accentClass={deco.ring} />\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <span className=\"font-medium\">{name}</span>\r\n                      {isMe && (\r\n                        <span className=\"text-[10px] px-1.5 py-0.5 rounded-full bg-lime-400/15 text-lime-300\">\r\n                          você\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Pontos (sem barra, sem setas) */}\r\n                  <div className=\"justify-self-end font-semibold\">\r\n                    <motion.span\r\n                      initial={{ opacity: 0, y: 4 }}\r\n                      animate={{ opacity: 1, y: 0 }}\r\n                      className={classNames(\r\n                        rank === 1\r\n                          ? \"text-lime-300\"\r\n                          : rank === 2\r\n                          ? \"text-indigo-300\"\r\n                          : rank === 3\r\n                          ? \"text-amber-300\"\r\n                          : \"text-white/90\"\r\n                      )}\r\n                    >\r\n                      {pts.toLocaleString(\"pt-BR\")}\r\n                    </motion.span>\r\n                  </div>\r\n                </motion.div>\r\n              );\r\n            })\r\n          )}\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      {/* Rodapé leve (sem paginação numerada, sem prev/next) */}\r\n      <p className=\"mt-3 text-xs opacity-60\">\r\n        {rows.length > 0\r\n          ? `${rows.length} usuário${rows.length === 1 ? \"\" : \"s\"} exibido${rows.length === 1 ? \"\" : \"s\"}`\r\n          : \"0 usuários\"}\r\n      </p>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;AAG3B;AACA;AAAA;AACA;AAAA;AAAA;AACA;AALA;;;;;;AAgBA,8DAA8D,GAC9D,SAAS,WAAW,GAAG,EAAqC;IAC1D,OAAO,GAAG,MAAM,CAAC,SAAS,IAAI,CAAC;AACjC;AAEA,SAAS,SAAS,IAAoB;IACpC,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,QAAQ,KAAK,IAAI,GAAG,KAAK,CAAC;IAChC,OAAO,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,EAAE,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,EAAE,IAAI,EAAE;AACtD;AAEA,SAAS,UAAU,IAAY;IAC7B,oCAAoC;IACpC,IAAI,SAAS,GACX,OAAO;QACL,KAAK;QACL,OAAO;QACP,MAAM;QACN,oBAAM,8OAAC,6MAAK;YAAC,MAAM;;;;;;IACrB;IACF,IAAI,SAAS,GACX,OAAO;QACL,KAAK;QACL,OAAO;QACP,MAAM;QACN,oBAAM,8OAAC,6MAAK;YAAC,MAAM;;;;;;IACrB;IACF,IAAI,SAAS,GACX,OAAO;QACL,KAAK;QACL,OAAO;QACP,MAAM;QACN,oBAAM,8OAAC,6MAAK;YAAC,MAAM;;;;;;IACrB;IACF,OAAO;QACL,KAAK;QACL,OAAO;QACP,MAAM;QACN,oBAAM,8OAAC,gNAAM;YAAC,MAAM;;;;;;IACtB;AACF;AAEA,8DAA8D,GAC9D,SAAS,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,WAAW,EAAuE;IAC7G,IAAI,KAAK;QACP,qBACE,8OAAC;YACC,KAAK;YACL,KAAK,QAAQ;YACb,WAAW,WACT,4DACA;;;;;;IAIR;IACA,qBACE,8OAAC;QACC,WAAW,WACT,0EACA,sCACA;kBAGD,SAAS;;;;;;AAGhB;AAGe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAY,EAAE;IAC9C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAgB;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,0DAA0D;IAC1D,IAAA,kNAAS,EAAC;QACR,CAAC;YACC,MAAM,WAAW,IAAA,mJAAe;YAEhC,MAAM,KAAK,MAAM,SAAS,IAAI,CAAC,OAAO;YACtC,QAAQ,GAAG,IAAI,CAAC,IAAI,EAAE,MAAM;YAE5B,uCAAuC;YACvC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SACpB,IAAI,CAAC,YACL,MAAM,CAAC,2CACP,KAAK,CAAC,UAAU;gBAAE,WAAW;gBAAO,YAAY;YAAM,GACtD,KAAK,CAAC;YAET,QAAQ,AAAC,QAAsB,EAAE;YACjC,WAAW;QACb,CAAC;IACH,GAAG,EAAE;IAEL,MAAM,YAAY,IAAA,gNAAO,EACvB,IAAM,KAAK,GAAG,CAAC,MAAO,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,MAAM,IAAI,KAChD;QAAC;KAAK;IAGR,qBACE,8OAAC;QAAK,WAAU;;0BAEd,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,gNAAM;wBAAC,WAAU;;;;;;kCAClB,8OAAC;wBAAG,WAAU;kCAAwC;;;;;;;;;;;;0BAIxD,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;0CAAI;;;;;;0CACL,8OAAC;0CAAI;;;;;;0CACL,8OAAC;gCAAI,WAAU;0CAAa;;;;;;;;;;;;kCAI9B,8OAAC,4MAAe;wBAAC,SAAS;kCACvB,UACC,MAAM,IAAI,CAAC;4BAAE,QAAQ;wBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBAChC,8OAAC,oMAAM,CAAC,GAAG;gCAET,SAAS;oCAAE,SAAS;gCAAE;gCACtB,SAAS;oCAAE,SAAS;gCAAE;gCACtB,MAAM;oCAAE,SAAS;gCAAE;gCACnB,WAAU;;kDAEV,8OAAC;wCAAI,WAAU;;;;;;kDACf,8OAAC;wCAAI,WAAU;;;;;;kDACf,8OAAC;wCAAI,WAAU;;;;;;;+BARV,CAAC,SAAS,EAAE,GAAG;;;;wCAWtB,KAAK,MAAM,KAAK,kBAClB,8OAAC;4BAAI,WAAU;sCAAuD;;;;;mCAItE,KAAK,GAAG,CAAC,CAAC,GAAG;4BACX,MAAM,OAAO,MAAM;4BACnB,MAAM,OAAO,EAAE,SAAS,IAAI,EAAE,IAAI,IAAI;4BACtC,MAAM,MAAM,EAAE,MAAM,IAAI;4BACxB,MAAM,OAAO,UAAU;4BACvB,MAAM,OAAO,QAAQ,EAAE,EAAE,KAAK;4BAE9B,qBACE,8OAAC,oMAAM,CAAC,GAAG;gCAET,MAAM;gCACN,SAAS;oCAAE,SAAS;oCAAG,GAAG;gCAAE;gCAC5B,SAAS;oCAAE,SAAS;oCAAG,GAAG;gCAAE;gCAC5B,MAAM;oCAAE,SAAS;oCAAG,GAAG,CAAC;gCAAE;gCAC1B,YAAY;oCAAE,UAAU;gCAAK;gCAC7B,WAAW,WACT,kFACA,sCACA,KAAK,GAAG;;kDAIV,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CACC,WAAW,WACT,gFACA,KAAK,KAAK;4CAEZ,OAAO,CAAC,QAAQ,EAAE,MAAM;sDAEvB,QAAQ,IAAI,KAAK,IAAI,iBAAG,8OAAC;gDAAK,WAAU;0DAAW;;;;;;;;;;;;;;;;kDAKxD,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAO,MAAM;gDAAM,KAAK,EAAE,UAAU,IAAI;gDAAW,aAAa,KAAK,IAAI;;;;;;0DAC1E,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAK,WAAU;kEAAe;;;;;;oDAC9B,sBACC,8OAAC;wDAAK,WAAU;kEAAsE;;;;;;;;;;;;;;;;;;kDAQ5F,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC,oMAAM,CAAC,IAAI;4CACV,SAAS;gDAAE,SAAS;gDAAG,GAAG;4CAAE;4CAC5B,SAAS;gDAAE,SAAS;gDAAG,GAAG;4CAAE;4CAC5B,WAAW,WACT,SAAS,IACL,kBACA,SAAS,IACT,oBACA,SAAS,IACT,mBACA;sDAGL,IAAI,cAAc,CAAC;;;;;;;;;;;;+BArDnB,EAAE,EAAE;;;;;wBA0Df;;;;;;;;;;;;0BAMN,8OAAC;gBAAE,WAAU;0BACV,KAAK,MAAM,GAAG,IACX,GAAG,KAAK,MAAM,CAAC,QAAQ,EAAE,KAAK,MAAM,KAAK,IAAI,KAAK,IAAI,QAAQ,EAAE,KAAK,MAAM,KAAK,IAAI,KAAK,KAAK,GAC9F;;;;;;;;;;;;AAIZ","debugId":null}}]
}