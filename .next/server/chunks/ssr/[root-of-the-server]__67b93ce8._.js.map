{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/app/u/%5Busername%5D/page.tsx"],"sourcesContent":["// src/app/u/[username]/page.tsx\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport { notFound } from \"next/navigation\";\r\nimport { Fragment } from \"react\";\r\n\r\n/** ========= Tipos vindos do endpoint /api/public-user/[username] ========= */\r\ntype CourseAgg = {\r\n  id: string;\r\n  title: string;\r\n  description: string | null;\r\n  totalModules: number;\r\n  completedModules: number;\r\n  percent: number;\r\n  lastCompletedAt: string | null;\r\n};\r\ntype ApiResp = {\r\n  ok: boolean;\r\n  error?: string;\r\n  profile?: {\r\n    id: string;\r\n    username: string | null;\r\n    name: string | null;\r\n    avatar_url: string | null;\r\n    bio: string | null;\r\n  };\r\n  totals?: { totalPoints: number };\r\n  courses?: CourseAgg[];\r\n};\r\n\r\nexport const dynamic = \"force-dynamic\";\r\nexport const revalidate = 0;\r\n\r\n/** ========= Helpers de UI ========= */\r\nfunction fmtDate(s?: string | null) {\r\n  if (!s) return \"—\";\r\n  try {\r\n    return new Date(s)\r\n      .toLocaleDateString(\"pt-BR\", { day: \"2-digit\", month: \"short\", year: \"numeric\" })\r\n      .replace(\".\", \"\");\r\n  } catch {\r\n    return \"—\";\r\n  }\r\n}\r\n\r\nfunction Line({ percent }: { percent: number }) {\r\n  const v = Math.max(0, Math.min(100, Math.round(percent)));\r\n  return (\r\n    <div className=\"h-2.5 w-full rounded-full bg-white/10 overflow-hidden\">\r\n      <div className=\"h-full bg-lime-400\" style={{ width: `${v}%` }} />\r\n    </div>\r\n  );\r\n}\r\n\r\n/** ========= Página ========= */\r\nexport default async function UserProfilePage({ params }: { params: { username: string } }) {\r\n  const slug = decodeURIComponent(params.username);\r\n\r\n  // Chamamos o endpoint server-side que agrega tudo com service role\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_BASE_URL ?? \"\"}/api/public-user/${encodeURIComponent(slug)}`, {\r\n    cache: \"no-store\",\r\n  }).catch(() => null);\r\n\r\n  if (!res) notFound();\r\n\r\n  const json = (await res.json()) as ApiResp;\r\n\r\n  if (!json.ok || !json.profile) {\r\n    // Se o username/id não existir, 404\r\n    notFound();\r\n  }\r\n\r\n  const profile = json.profile;\r\n  const name = profile.name || profile.username || \"Jogador\";\r\n  const points = json.totals?.totalPoints ?? 0;\r\n  const courses = json.courses ?? [];\r\n\r\n  return (\r\n    <main className=\"px-5 md:px-8 py-8 text-white\">\r\n      <div className=\"max-w-3xl mx-auto\">\r\n        <div className=\"relative overflow-hidden rounded-3xl p-6 md:p-8 bg-gradient-to-b from-neutral-900 to-black border border-white/10 shadow-[inset_0_0_0_1px_rgba(255,255,255,0.05)]\">\r\n          {/* aurora */}\r\n          <div\r\n            className=\"pointer-events-none absolute -top-28 left-1/2 -translate-x-1/2 h-72 w-72 rounded-full blur-3xl\"\r\n            style={{ background: \"radial-gradient(circle, rgba(163,230,53,0.22), transparent)\" }}\r\n          />\r\n\r\n          {/* Header */}\r\n          <div className=\"relative z-10 flex items-center gap-4\">\r\n            <Avatar src={profile.avatar_url} alt={name} />\r\n            <div className=\"min-w-0\">\r\n              <h1 className=\"text-2xl font-semibold tracking-tight text-lime-300 drop-shadow-[0_0_10px_rgba(163,230,53,0.25)] truncate\">\r\n                {name}\r\n              </h1>\r\n              <p className=\"text-sm text-white/70 truncate\">\r\n                {profile.username ? `@${profile.username}` : profile.id.slice(0, 8)}\r\n              </p>\r\n              {profile.bio && (\r\n                <p className=\"mt-2 text-sm text-white/80 whitespace-pre-wrap\">{profile.bio}</p>\r\n              )}\r\n            </div>\r\n            <div className=\"ml-auto flex items-center gap-2\">\r\n              <span className=\"h-9 px-3 rounded-xl bg-white/5 border border-white/10 text-sm grid place-items-center\">\r\n                {points.toLocaleString(\"pt-BR\")} pts\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Visão geral simples (pontos apenas por enquanto) */}\r\n          <section className=\"relative z-10 border-t border-white/5 mt-6 pt-6\">\r\n            <h2 className=\"text-lime-300/90 font-semibold text-base mb-4\">Visão geral</h2>\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\r\n              <Stat label=\"Pontos\" value={points.toLocaleString(\"pt-BR\")} />\r\n              <Stat label=\"Posição\" value=\"—\" hint=\"via ranking\" />\r\n              <Stat label=\"Maior Streak\" value=\"—\" hint=\"em breve\" />\r\n            </div>\r\n          </section>\r\n\r\n          {/* Progresso por curso (dados reais do endpoint) */}\r\n          <section className=\"relative z-10 border-t border-white/5 mt-6 pt-6\">\r\n            <h2 className=\"text-lime-300/90 font-semibold text-base mb-4\">Progresso</h2>\r\n            {courses.length === 0 ? (\r\n              <div className=\"text-sm text-white/70\">Sem progresso para mostrar.</div>\r\n            ) : (\r\n              <div className=\"rounded-2xl overflow-hidden bg-white/[0.03] border border-white/10\">\r\n                <div className=\"hidden md:grid grid-cols-[1fr,240px,120px,160px] px-6 py-3 text-xs uppercase tracking-wide text-white/60 border-b border-white/10\">\r\n                  <div>Curso</div>\r\n                  <div>Progresso</div>\r\n                  <div>Concluído</div>\r\n                  <div>Última conclusão</div>\r\n                </div>\r\n                <ul className=\"divide-y divide-white/10\">\r\n                  {courses.map((c) => (\r\n                    <li\r\n                      key={c.id}\r\n                      className=\"grid md:grid-cols-[1fr,240px,120px,160px] grid-cols-1 gap-3 px-6 py-5 hover:bg-white/[0.04] transition-colors\"\r\n                    >\r\n                      <div>\r\n                        <Link href={`/curso/${c.id}`} className=\"font-medium text-white/90 hover:underline\">\r\n                          {c.title}\r\n                        </Link>\r\n                        {c.description && <div className=\"text-sm text-white/60\">{c.description}</div>}\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center gap-3 self-center\">\r\n                        <Line percent={c.percent} />\r\n                        <span className=\"text-sm text-white/70\">{c.percent}%</span>\r\n                      </div>\r\n\r\n                      <div className=\"self-center text-sm text-white/80\">\r\n                        {c.completedModules}/{c.totalModules}\r\n                      </div>\r\n\r\n                      <div className=\"self-center text-sm text-white/70\">{fmtDate(c.lastCompletedAt)}</div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n          </section>\r\n\r\n          {/* Atividade / Conquistas — placeholders (opcional evoluir depois) */}\r\n          <section className=\"relative z-10 border-t border-white/5 mt-6 pt-6\">\r\n            <h2 className=\"text-lime-300/90 font-semibold text-base mb-4\">Atividade</h2>\r\n            <div className=\"text-sm text-white/70\">Sem atividades recentes.</div>\r\n          </section>\r\n\r\n          <section className=\"relative z-10 border-t border-white/5 mt-6 pt-6\">\r\n            <h2 className=\"text-lime-300/90 font-semibold text-base mb-4\">Conquistas</h2>\r\n            <div className=\"text-sm text-white/70\">Em breve.</div>\r\n          </section>\r\n        </div>\r\n\r\n        {/* Rodapé com link de volta ao ranking */}\r\n        <div className=\"mt-4 text-center\">\r\n          <Link href=\"/ranking\" className=\"text-sm opacity-80 hover:opacity-100 underline\">\r\n            ← Voltar ao ranking\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\n/** ========= Subcomponentes ========= */\r\nfunction Avatar({ src, alt }: { src?: string | null; alt: string }) {\r\n  const fallback = \"/logo.png\";\r\n  return (\r\n    <div className=\"w-16 h-16 rounded-2xl overflow-hidden border border-white/10 bg-white/5 grid place-items-center\">\r\n      <Image src={src || fallback} alt={alt} width={64} height={64} className=\"object-cover\" />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Stat({ label, value, hint }: { label: string; value: string; hint?: string }) {\r\n  return (\r\n    <div className=\"rounded-xl border border-white/10 bg-white/5 p-3\">\r\n      <div className=\"text-xs text-white/60\">{label}</div>\r\n      <div className=\"text-lg font-semibold\">{value}</div>\r\n      {hint && <div className=\"text-[11px] text-white/50 mt-0.5\">{hint}</div>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}