{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/lib/supabase/client.ts"],"sourcesContent":["// src/lib/supabase/client.ts\r\nimport { createClient, type SupabaseClient } from \"@supabase/supabase-js\";\r\n\r\nlet _client: SupabaseClient | null = null;\r\n\r\n/**\r\n * Cliente do Supabase para uso no browser (componentes client).\r\n * Usa storageKey custom \"sr-auth\" para evitar conflitos e manter sessão.\r\n */\r\nexport function supabaseBrowser(): SupabaseClient {\r\n  if (_client) return _client;\r\n\r\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n  if (!url || !anon) {\r\n    throw new Error(\r\n      \"Env vars ausentes: defina NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\r\n    );\r\n  }\r\n\r\n  _client = createClient(url, anon, {\r\n    auth: {\r\n      persistSession: true,\r\n      autoRefreshToken: true,\r\n      storageKey: \"sr-auth\",\r\n    },\r\n  });\r\n\r\n  return _client;\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;AAYf;AAXd;;AAEA,IAAI,UAAiC;AAM9B,SAAS;IACd,IAAI,SAAS,OAAO;IAEpB,MAAM;IACN,MAAM;IAEN;;IAMA,UAAU,IAAA,0MAAY,EAAC,KAAK,MAAM;QAChC,MAAM;YACJ,gBAAgB;YAChB,kBAAkB;YAClB,YAAY;QACd;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/app/ranking/page.tsx"],"sourcesContent":["// src/app/ranking/page.tsx\r\n\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Crown, Medal, Trophy } from \"lucide-react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\n\r\n/* ------------------------- Tipos ------------------------- */\r\ntype Profile = {\r\n  id: string;\r\n  full_name?: string | null;\r\n  name?: string | null;\r\n  avatar_url?: string | null;\r\n  points?: number | null; // ajuste se sua coluna tiver outro nome\r\n};\r\n\r\n/* --------------------- Util / helpers --------------------- */\r\nfunction classNames(...xs: Array<string | false | undefined>) {\r\n  return xs.filter(Boolean).join(\" \");\r\n}\r\n\r\nfunction initials(name?: string | null) {\r\n  if (!name) return \"U\";\r\n  const parts = name.trim().split(/\\s+/);\r\n  return (parts[0]?.[0] ?? \"U\") + (parts[1]?.[0] ?? \"\");\r\n}\r\n\r\nfunction rankDecor(rank: number) {\r\n  // estilos específicos para 1º/2º/3º\r\n  if (rank === 1)\r\n    return {\r\n      row: \"bg-gradient-to-r from-lime-400/10 to-emerald-400/10\",\r\n      badge: \"text-lime-300 drop-shadow-[0_0_8px_rgba(163,230,53,0.45)]\",\r\n      ring: \"ring-2 ring-lime-400/40\",\r\n      icon: <Crown size={18} />,\r\n    };\r\n  if (rank === 2)\r\n    return {\r\n      row: \"bg-gradient-to-r from-indigo-400/10 to-blue-400/10\",\r\n      badge: \"text-indigo-300 drop-shadow-[0_0_8px_rgba(99,102,241,0.45)]\",\r\n      ring: \"ring-2 ring-indigo-400/40\",\r\n      icon: <Medal size={18} />,\r\n    };\r\n  if (rank === 3)\r\n    return {\r\n      row: \"bg-gradient-to-r from-amber-400/10 to-orange-400/10\",\r\n      badge: \"text-amber-300 drop-shadow-[0_0_8px_rgba(245,158,11,0.45)]\",\r\n      ring: \"ring-2 ring-amber-400/40\",\r\n      icon: <Medal size={18} />,\r\n    };\r\n  return {\r\n    row: \"\",\r\n    badge: \"text-white/60\",\r\n    ring: \"ring-0\",\r\n    icon: <Trophy size={16} />,\r\n  };\r\n}\r\n\r\n/* --------------------- Avatar circular -------------------- */\r\nfunction Avatar({ name, url, accentClass }: { name?: string | null; url?: string | null; accentClass?: string }) {\r\n  if (url) {\r\n    return (\r\n      <img\r\n        src={url}\r\n        alt={name ?? \"avatar\"}\r\n        className={classNames(\r\n          \"w-8 h-8 rounded-full object-cover border border-white/10\",\r\n          accentClass\r\n        )}\r\n      />\r\n    );\r\n  }\r\n  return (\r\n    <div\r\n      className={classNames(\r\n        \"w-8 h-8 rounded-full grid place-items-center text-[11px] font-semibold\",\r\n        \"bg-white/10 border border-white/10\",\r\n        accentClass\r\n      )}\r\n    >\r\n      {initials(name)}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------- Componente ----------------------- */\r\nexport default function RankingPage() {\r\n  const [rows, setRows] = useState<Profile[]>([]);\r\n  const [meId, setMeId] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Carrega ranking (profiles ordenado por pontos) + meu ID\r\n  useEffect(() => {\r\n    (async () => {\r\n      const supabase = supabaseBrowser();\r\n\r\n      const me = await supabase.auth.getUser();\r\n      setMeId(me.data.user?.id ?? null);\r\n\r\n      // ajuste os campos conforme seu schema\r\n      const { data } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"id, full_name, name, avatar_url, points\")\r\n        .order(\"points\", { ascending: false, nullsFirst: false })\r\n        .limit(100);\r\n\r\n      setRows((data as Profile[]) ?? []);\r\n      setLoading(false);\r\n    })();\r\n  }, []);\r\n\r\n  const maxPoints = useMemo(\r\n    () => Math.max(1, ...(rows.map(r => r.points ?? 0))),\r\n    [rows]\r\n  );\r\n\r\n  return (\r\n    <main className=\"max-w-3xl mx-auto\">\r\n      {/* Título */}\r\n      <div className=\"flex items-center gap-2 mb-4\">\r\n        <Trophy className=\"text-lime-300\" />\r\n        <h1 className=\"text-2xl font-semibold tracking-tight\">Ranking</h1>\r\n      </div>\r\n\r\n      {/* Card/Tabela */}\r\n      <div className=\"rounded-2xl border border-white/10 overflow-hidden shadow-[0_0_36px_-18px_rgba(163,230,53,0.25)]\">\r\n        {/* Cabeçalho */}\r\n        <div className=\"grid grid-cols-[72px_1fr_120px] items-center px-4 py-3 bg-gradient-to-r from-lime-400/10 via-green-400/5 to-transparent text-xs uppercase tracking-wider text-white/60\">\r\n          <div>Posição</div>\r\n          <div>Usuário</div>\r\n          <div className=\"text-right\">Pontos</div>\r\n        </div>\r\n\r\n        {/* Linhas */}\r\n        <AnimatePresence initial={false}>\r\n          {loading ? (\r\n            Array.from({ length: 5 }).map((_, i) => (\r\n              <motion.div\r\n                key={`skeleton-${i}`}\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                className=\"grid grid-cols-[72px_1fr_120px] items-center px-4 py-3 border-t border-white/5\"\r\n              >\r\n                <div className=\"h-4 w-10 bg-white/10 rounded\" />\r\n                <div className=\"h-4 w-40 bg-white/10 rounded\" />\r\n                <div className=\"h-4 w-16 bg-white/10 rounded justify-self-end\" />\r\n              </motion.div>\r\n            ))\r\n          ) : rows.length === 0 ? (\r\n            <div className=\"px-4 py-6 text-sm opacity-70 border-t border-white/5\">\r\n              Ninguém no ranking ainda. Conclua módulos para começar a pontuar!\r\n            </div>\r\n          ) : (\r\n            rows.map((r, idx) => {\r\n              const rank = idx + 1;\r\n              const name = r.full_name || r.name || \"Usuário\";\r\n              const pts = r.points ?? 0;\r\n              const deco = rankDecor(rank);\r\n              const isMe = meId && r.id === meId;\r\n\r\n              return (\r\n                <motion.div\r\n                  key={r.id}\r\n                  layout\r\n                  initial={{ opacity: 0, y: 6 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  exit={{ opacity: 0, y: -6 }}\r\n                  transition={{ duration: 0.18 }}\r\n                  className={classNames(\r\n                    \"grid grid-cols-[72px_1fr_120px] items-center px-4 py-3 border-t border-white/5\",\r\n                    \"hover:bg-white/5 transition-colors\",\r\n                    deco.row\r\n                  )}\r\n                >\r\n                  {/* Posição + medalha */}\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div\r\n                      className={classNames(\r\n                        \"w-8 h-8 rounded-lg grid place-items-center bg-white/5 border border-white/10\",\r\n                        deco.badge\r\n                      )}\r\n                      title={`Posição ${rank}`}\r\n                    >\r\n                      {rank <= 3 ? deco.icon : <span className=\"text-xs\">{rank}</span>}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Usuário */}\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <Avatar name={name} url={r.avatar_url ?? undefined} accentClass={deco.ring} />\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <span className=\"font-medium\">{name}</span>\r\n                      {isMe && (\r\n                        <span className=\"text-[10px] px-1.5 py-0.5 rounded-full bg-lime-400/15 text-lime-300\">\r\n                          você\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Pontos (sem barra, sem setas) */}\r\n                  <div className=\"justify-self-end font-semibold\">\r\n                    <motion.span\r\n                      initial={{ opacity: 0, y: 4 }}\r\n                      animate={{ opacity: 1, y: 0 }}\r\n                      className={classNames(\r\n                        rank === 1\r\n                          ? \"text-lime-300\"\r\n                          : rank === 2\r\n                          ? \"text-indigo-300\"\r\n                          : rank === 3\r\n                          ? \"text-amber-300\"\r\n                          : \"text-white/90\"\r\n                      )}\r\n                    >\r\n                      {pts.toLocaleString(\"pt-BR\")}\r\n                    </motion.span>\r\n                  </div>\r\n                </motion.div>\r\n              );\r\n            })\r\n          )}\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      {/* Rodapé leve (sem paginação numerada, sem prev/next) */}\r\n      <p className=\"mt-3 text-xs opacity-60\">\r\n        {rows.length > 0\r\n          ? `${rows.length} usuário${rows.length === 1 ? \"\" : \"s\"} exibido${rows.length === 1 ? \"\" : \"s\"}`\r\n          : \"0 usuários\"}\r\n      </p>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}