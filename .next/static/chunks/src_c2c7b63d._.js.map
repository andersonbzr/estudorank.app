{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/lib/supabase/client.ts"],"sourcesContent":["// src/lib/supabase/client.ts\r\nimport { createClient, type SupabaseClient } from \"@supabase/supabase-js\";\r\n\r\nlet _client: SupabaseClient | null = null;\r\n\r\n/**\r\n * Cliente do Supabase para uso no browser (componentes client).\r\n * Usa storageKey custom \"sr-auth\" para evitar conflitos e manter sessão.\r\n */\r\nexport function supabaseBrowser(): SupabaseClient {\r\n  if (_client) return _client;\r\n\r\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n  if (!url || !anon) {\r\n    throw new Error(\r\n      \"Env vars ausentes: defina NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\r\n    );\r\n  }\r\n\r\n  _client = createClient(url, anon, {\r\n    auth: {\r\n      persistSession: true,\r\n      autoRefreshToken: true,\r\n      storageKey: \"sr-auth\",\r\n    },\r\n  });\r\n\r\n  return _client;\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;AAYf;AAXd;;AAEA,IAAI,UAAiC;AAM9B,SAAS;IACd,IAAI,SAAS,OAAO;IAEpB,MAAM;IACN,MAAM;IAEN;;IAMA,UAAU,IAAA,0MAAY,EAAC,KAAK,MAAM;QAChC,MAAM;YACJ,gBAAgB;YAChB,kBAAkB;YAClB,YAAY;QACd;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/AuthGuard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\n\r\n/**\r\n * Bloqueia acesso de quem não está autenticado.\r\n * Mostra um fallback simples enquanto verifica a sessão.\r\n */\r\nexport default function AuthGuard({ children }: { children: React.ReactNode }) {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const supabase = supabaseBrowser();\r\n\r\n  const [ready, setReady] = useState(false);\r\n  const [authed, setAuthed] = useState<boolean | null>(null);\r\n\r\n  useEffect(() => {\r\n    let unsub: (() => void) | null = null;\r\n    (async () => {\r\n      const { data } = await supabase.auth.getSession();\r\n      setAuthed(!!data.session);\r\n      setReady(true);\r\n\r\n      const sub = supabase.auth.onAuthStateChange((_event, session) => {\r\n        setAuthed(!!session);\r\n        if (!session) {\r\n          // Se deslogar, volta ao login\r\n          router.replace(\"/login\");\r\n        }\r\n      });\r\n      unsub = () => sub.data.subscription.unsubscribe();\r\n    })();\r\n\r\n    return () => {\r\n      if (unsub) unsub();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [pathname]);\r\n\r\n  if (!ready) {\r\n    return (\r\n      <div className=\"min-h-[50vh] grid place-items-center text-white/70\">\r\n        Carregando…\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!authed) return null;\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAUe,SAAS,UAAU,KAA2C;QAA3C,EAAE,QAAQ,EAAiC,GAA3C;;IAChC,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,WAAW,IAAA,sJAAe;IAEhC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAiB;IAErD,IAAA,0KAAS;+BAAC;YACR,IAAI,QAA6B;YACjC;uCAAC;oBACC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;oBAC/C,UAAU,CAAC,CAAC,KAAK,OAAO;oBACxB,SAAS;oBAET,MAAM,MAAM,SAAS,IAAI,CAAC,iBAAiB;mDAAC,CAAC,QAAQ;4BACnD,UAAU,CAAC,CAAC;4BACZ,IAAI,CAAC,SAAS;gCACZ,8BAA8B;gCAC9B,OAAO,OAAO,CAAC;4BACjB;wBACF;;oBACA,QAZF;+CAYU,IAAM,IAAI,IAAI,CAAC,YAAY,CAAC,WAAW;qBAChD;gBAAD;;YAEA;uCAAO;oBACL,IAAI,OAAO;gBACb;;QACA,uDAAuD;QACzD;8BAAG;QAAC;KAAS;IAEb,IAAI,CAAC,OAAO;QACV,qBACE,6LAAC;YAAI,WAAU;sBAAqD;;;;;;IAIxE;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBAAO;kBAAG;;AACZ;GA1CwB;;QACP,kJAAS;QACP,oJAAW;;;KAFN","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/Sidebar.tsx"],"sourcesContent":["// src/components/Sidebar.tsx\r\n\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport { Trophy, LayoutDashboard, Settings, ShieldCheck } from \"lucide-react\";\r\nimport Image from \"next/image\";\r\nimport clsx from \"clsx\";\r\n\r\ntype Props = {\r\n  onNavigate?: () => void;\r\n  isAdmin?: boolean;\r\n  collapsed?: boolean;\r\n};\r\n\r\ntype Item = { href: string; label: string; icon: React.ComponentType<any> };\r\n\r\nexport default function Sidebar({ onNavigate, isAdmin, collapsed = false }: Props) {\r\n  const pathname = usePathname();\r\n\r\n  const primary: Item[] = [\r\n    { href: \"/me\", label: \"Meu Painel\", icon: LayoutDashboard },\r\n    { href: \"/ranking\", label: \"Ranking\", icon: Trophy },\r\n    { href: \"/config\", label: \"Configurações\", icon: Settings },\r\n  ];\r\n\r\n  const admin: Item[] = isAdmin\r\n    ? [{ href: \"/admin/courses\", label: \"Administração\", icon: ShieldCheck }]\r\n    : [];\r\n\r\n  return (\r\n    <aside className=\"h-screen sticky top-0 bg-[var(--surface)]/80 backdrop-blur-xl border-r border-white/10 flex flex-col\">\r\n      {/* Header / Logo */}\r\n      <div\r\n        className={clsx(\r\n          \"h-12 border-b border-white/10 px-3 flex items-center\",\r\n          collapsed && \"justify-center px-0\"\r\n        )}\r\n      >\r\n        <Link\r\n          href=\"/me\"\r\n          className={clsx(\r\n            \"flex items-center gap-2 rounded-lg hover:bg-white/5 px-2 py-1 transition\",\r\n            collapsed && \"justify-center px-1\"\r\n          )}\r\n          onClick={onNavigate}\r\n          aria-label=\"Ir para o painel\"\r\n          title=\"EstudoRank\"\r\n        >\r\n          {!collapsed ? (\r\n            <Image\r\n              src=\"/logo.png\"\r\n              alt=\"EstudoRank\"\r\n              width={200}\r\n              height={60}\r\n              priority\r\n              className=\"h-7 md:h-8 lg:h-9 w-auto object-contain drop-shadow-[0_0_5px_rgba(163,230,53,0.25)]\"\r\n            />\r\n          ) : (\r\n            <Image\r\n              src=\"/logo.col.png\"\r\n              alt=\"ER\"\r\n              width={200}\r\n              height={60}\r\n              priority\r\n              className=\"h-6 w-auto object-contain drop-shadow-[0_0_4px_rgba(163,230,53,0.30)]\"\r\n            />\r\n          )}\r\n\r\n          {/* {!collapsed && (\r\n            <span className=\"ml-1 font-semibold text-sm tracking-tight text-white/90\">\r\n              Estudo<span className=\"text-lime-300\">Rank</span>\r\n            </span>\r\n          )} */}\r\n        </Link>\r\n      </div>\r\n\r\n      {/* Navegação */}\r\n      <nav className={clsx(\"flex-1 p-2 space-y-2\", collapsed && \"p-2\")}>\r\n        <Section items={primary} collapsed={collapsed} onNavigate={onNavigate} />\r\n        {isAdmin && (\r\n          <>\r\n            {!collapsed && (\r\n              <div className=\"px-3 pt-2\">\r\n                <div className=\"h-px bg-white/10\" />\r\n              </div>\r\n            )}\r\n            <Section\r\n              title={collapsed ? undefined : \"Admin\"}\r\n              items={admin}\r\n              collapsed={collapsed}\r\n              onNavigate={onNavigate}\r\n            />\r\n          </>\r\n        )}\r\n      </nav>\r\n\r\n      {/* Footer */}\r\n      {!collapsed ? (\r\n        <div className=\"px-3 py-2 text-xs opacity-60 border-t border-white/10\">\r\n          © {new Date().getFullYear()} EstudoRank\r\n        </div>\r\n      ) : (\r\n        <div className=\"py-2 border-t border-white/10 text-center text-[10px] opacity-50 select-none\">\r\n          © {new Date().getFullYear()}\r\n        </div>\r\n      )}\r\n    </aside>\r\n  );\r\n}\r\n\r\n/* --------------------------- Subcomponentes --------------------------- */\r\n\r\nfunction Section({\r\n  title,\r\n  items,\r\n  collapsed,\r\n  onNavigate,\r\n}: {\r\n  title?: string;\r\n  items: Item[];\r\n  collapsed: boolean;\r\n  onNavigate?: () => void;\r\n}) {\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      {title && !collapsed && (\r\n        <div className=\"px-3 pt-1 text-[11px] uppercase tracking-wide text-white/40\">\r\n          {title}\r\n        </div>\r\n      )}\r\n      <ul className=\"space-y-1.5\">\r\n        {items.map((it) => (\r\n          <li key={it.href}>\r\n            <NavItem item={it} collapsed={collapsed} onNavigate={onNavigate} />\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction NavItem({\r\n  item,\r\n  collapsed,\r\n  onNavigate,\r\n}: {\r\n  item: Item;\r\n  collapsed: boolean;\r\n  onNavigate?: () => void;\r\n}) {\r\n  const pathname = usePathname();\r\n  const active = pathname === item.href || pathname.startsWith(`${item.href}/`);\r\n  const Icon = item.icon;\r\n\r\n  return (\r\n    <Link\r\n      href={item.href}\r\n      onClick={onNavigate}\r\n      aria-current={active ? \"page\" : undefined}\r\n      className={clsx(\r\n        \"group relative flex items-center gap-2 rounded-xl border transition-all duration-200 outline-none focus-visible:ring-2 focus-visible:ring-lime-400/30\",\r\n        collapsed ? \"justify-center p-1.5\" : \"px-2.5 py-1.5\",\r\n        active\r\n          ? \"bg-white/7 border-white/15 text-lime-200\"\r\n          : \"bg-white/5 hover:bg-white/10 border-white/10 text-white/85 hover:text-white\"\r\n      )}\r\n    >\r\n      <Icon\r\n        size={17}\r\n        className={clsx(\"transition-transform\", active ? \"scale-[1.02]\" : \"group-hover:scale-105\")}\r\n        aria-hidden\r\n      />\r\n      {!collapsed && <span className=\"text-[13px]\">{item.label}</span>}\r\n\r\n      {collapsed && (\r\n        <span\r\n          className={clsx(\r\n            \"pointer-events-none absolute left-full ml-3 top-1/2 -translate-y-1/2\",\r\n            \"rounded-md bg-black/80 text-white text-xs px-2 py-1\",\r\n            \"opacity-0 -translate-x-1 group-hover:opacity-100 group-hover:translate-x-0\",\r\n            \"transition-all whitespace-nowrap z-50\"\r\n          )}\r\n          role=\"tooltip\"\r\n        >\r\n          {item.label}\r\n        </span>\r\n      )}\r\n    </Link>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;AAG7B;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;AANA;;;;;;AAgBe,SAAS,QAAQ,KAAiD;QAAjD,EAAE,UAAU,EAAE,OAAO,EAAE,YAAY,KAAK,EAAS,GAAjD;;IAC9B,MAAM,WAAW,IAAA,oJAAW;IAE5B,MAAM,UAAkB;QACtB;YAAE,MAAM;YAAO,OAAO;YAAc,MAAM,kPAAe;QAAC;QAC1D;YAAE,MAAM;YAAY,OAAO;YAAW,MAAM,mNAAM;QAAC;QACnD;YAAE,MAAM;YAAW,OAAO;YAAiB,MAAM,yNAAQ;QAAC;KAC3D;IAED,MAAM,QAAgB,UAClB;QAAC;YAAE,MAAM;YAAkB,OAAO;YAAiB,MAAM,sOAAW;QAAC;KAAE,GACvE,EAAE;IAEN,qBACE,6LAAC;QAAM,WAAU;;0BAEf,6LAAC;gBACC,WAAW,IAAA,mJAAI,EACb,wDACA,aAAa;0BAGf,cAAA,6LAAC,0KAAI;oBACH,MAAK;oBACL,WAAW,IAAA,mJAAI,EACb,4EACA,aAAa;oBAEf,SAAS;oBACT,cAAW;oBACX,OAAM;8BAEL,CAAC,0BACA,6LAAC,2IAAK;wBACJ,KAAI;wBACJ,KAAI;wBACJ,OAAO;wBACP,QAAQ;wBACR,QAAQ;wBACR,WAAU;;;;;6CAGZ,6LAAC,2IAAK;wBACJ,KAAI;wBACJ,KAAI;wBACJ,OAAO;wBACP,QAAQ;wBACR,QAAQ;wBACR,WAAU;;;;;;;;;;;;;;;;0BAalB,6LAAC;gBAAI,WAAW,IAAA,mJAAI,EAAC,wBAAwB,aAAa;;kCACxD,6LAAC;wBAAQ,OAAO;wBAAS,WAAW;wBAAW,YAAY;;;;;;oBAC1D,yBACC;;4BACG,CAAC,2BACA,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;;;;;;;;;;0CAGnB,6LAAC;gCACC,OAAO,YAAY,YAAY;gCAC/B,OAAO;gCACP,WAAW;gCACX,YAAY;;;;;;;;;;;;;;YAOnB,CAAC,0BACA,6LAAC;gBAAI,WAAU;;oBAAwD;oBAClE,IAAI,OAAO,WAAW;oBAAG;;;;;;qCAG9B,6LAAC;gBAAI,WAAU;;oBAA+E;oBACzF,IAAI,OAAO,WAAW;;;;;;;;;;;;;AAKnC;GA5FwB;;QACL,oJAAW;;;KADN;AA8FxB,0EAA0E,GAE1E,SAAS,QAAQ,KAUhB;QAVgB,EACf,KAAK,EACL,KAAK,EACL,SAAS,EACT,UAAU,EAMX,GAVgB;IAWf,qBACE,6LAAC;QAAI,WAAU;;YACZ,SAAS,CAAC,2BACT,6LAAC;gBAAI,WAAU;0BACZ;;;;;;0BAGL,6LAAC;gBAAG,WAAU;0BACX,MAAM,GAAG,CAAC,CAAC,mBACV,6LAAC;kCACC,cAAA,6LAAC;4BAAQ,MAAM;4BAAI,WAAW;4BAAW,YAAY;;;;;;uBAD9C,GAAG,IAAI;;;;;;;;;;;;;;;;AAO1B;MA3BS;AA6BT,SAAS,QAAQ,KAQhB;QARgB,EACf,IAAI,EACJ,SAAS,EACT,UAAU,EAKX,GARgB;;IASf,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,SAAS,aAAa,KAAK,IAAI,IAAI,SAAS,UAAU,CAAC,AAAC,GAAY,OAAV,KAAK,IAAI,EAAC;IAC1E,MAAM,OAAO,KAAK,IAAI;IAEtB,qBACE,6LAAC,0KAAI;QACH,MAAM,KAAK,IAAI;QACf,SAAS;QACT,gBAAc,SAAS,SAAS;QAChC,WAAW,IAAA,mJAAI,EACb,yJACA,YAAY,yBAAyB,iBACrC,SACI,6CACA;;0BAGN,6LAAC;gBACC,MAAM;gBACN,WAAW,IAAA,mJAAI,EAAC,wBAAwB,SAAS,iBAAiB;gBAClE,aAAW;;;;;;YAEZ,CAAC,2BAAa,6LAAC;gBAAK,WAAU;0BAAe,KAAK,KAAK;;;;;;YAEvD,2BACC,6LAAC;gBACC,WAAW,IAAA,mJAAI,EACb,wEACA,uDACA,8EACA;gBAEF,MAAK;0BAEJ,KAAK,KAAK;;;;;;;;;;;;AAKrB;IAhDS;;QASU,oJAAW;;;MATrB","debugId":null}},
    {"offset": {"line": 400, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/I18nProvider.tsx"],"sourcesContent":["// src/components/I18nProvider.tsx\r\n\"use client\";\r\n\r\nimport React, { createContext, useContext, useEffect, useMemo, useState } from \"react\";\r\n\r\n/**\r\n * Dicionários simples. Mantive pt-BR como padrão.\r\n * Se quiser, pode preencher/enxugar o en-US — o app vai cair no pt-BR quando faltar chave.\r\n */\r\ntype Dict = Record<string, string | ((vars?: Record<string, any>) => string)>;\r\n\r\nconst ptBR: Dict = {\r\n  // Globais / Header / Sidebar\r\n  welcome: ({ name }: any) => (name ? `Bem-vindo, ${name}` : \"Bem-vindo\"),\r\n  myPanel: \"Meu Painel\",\r\n  ranking: \"Ranking\",\r\n  settings: \"Configurações\",\r\n  admin: \"Admin\",\r\n  refresh: \"Atualizar\",\r\n  prev: \"Anterior\",\r\n  next: \"Próxima\",\r\n  signOut: \"Sair\",\r\n\r\n  // Página /me\r\n  yourPoints: \"Seus pontos:\",\r\n  creatingExample: \"Criando exemplo...\",\r\n  createExample: \"Criar dados de exemplo\",\r\n  weeklyGoalLabel: ({ done, goal }: any) => `Meta semanal (seg–dom): ${done}/${goal} módulos`,\r\n  saveGoal: \"Salvar meta\",\r\n  generalProgress: \"Progresso geral\",\r\n  modulesCompleted: ({ done, total }: any) => `${done}/${total} módulos concluídos`,\r\n  loadingCoursesModules: \"Carregando cursos e módulos...\",\r\n  noActiveCourses: \"Nenhum curso ativo. Use “Criar dados de exemplo”.\",\r\n  donePlusPoints: \"Concluído (+10 pts)\",\r\n  pending: \"Pendente\",\r\n  updating: \"Atualizando...\",\r\n  undo: \"Desfazer\",\r\n  conclude: \"Concluir\",\r\n\r\n  // Admin / Cursos\r\n  adminCoursesTitle: \"Admin • Cursos & Módulos\",\r\n  adminCoursesSubtitle:\r\n    \"Crie cursos, adicione módulos, ative/desative e edite títulos. Somente administradores podem alterar.\",\r\n  demoMode: \"Modo Demo\",\r\n  demoModeDesc: \"Popula vários cursos e módulos de exemplo.\",\r\n  populating: \"Populando...\",\r\n  populateDemo: \"Popular demo\",\r\n  newCourse: \"Novo curso\",\r\n  courseTitlePlaceholder: \"Título do curso\",\r\n  courseDescPlaceholder: \"Descrição (opcional)\",\r\n  creating: \"Criando...\",\r\n  createCourse: \"Criar curso\",\r\n  titleLabel: \"Título\",\r\n  disable: \"Desativar\",\r\n  enable: \"Ativar\",\r\n  delete: \"Excluir\",\r\n  modulePlaceholder: \"Novo módulo...\",\r\n  addModule: \"Adicionar módulo\",\r\n  adding: \"Adicionando...\",\r\n  moduleLabel: \"Módulo\",\r\n  save: \"Salvar\",\r\n  cancel: \"Cancelar\",\r\n  edit: \"Editar\",\r\n  loading: \"Carregando...\",\r\n  noCourses: \"Nenhum curso. Crie um acima.\",\r\n\r\n  // Ranking\r\n  position: \"Posição\",\r\n  user: \"Usuário\",\r\n  points: \"Pontos\",\r\n  loadingRanking: \"Carregando ranking...\",\r\n  noDataYet: \"Sem dados ainda.\",\r\n  paginationSummary: ({ total, page, pages }: any) => `${total} usuários • página ${page} de ${pages}`,\r\n};\r\n\r\nconst enUS: Dict = {\r\n  // (opcional, serve como fallback para quando você selecionar \"en-US\" no futuro)\r\n  welcome: ({ name }: any) => (name ? `Welcome, ${name}` : \"Welcome\"),\r\n  myPanel: \"My Panel\",\r\n  ranking: \"Ranking\",\r\n  settings: \"Settings\",\r\n  admin: \"Admin\",\r\n  refresh: \"Refresh\",\r\n  prev: \"Previous\",\r\n  next: \"Next\",\r\n  signOut: \"Sign out\",\r\n};\r\n\r\nexport type Locale = \"pt-BR\" | \"en-US\";\r\n\r\nconst dictionaries: Record<Locale, Dict> = {\r\n  \"pt-BR\": ptBR,\r\n  \"en-US\": enUS,\r\n};\r\n\r\ntype I18nCtxType = {\r\n  locale: Locale;\r\n  setLocale: (l: Locale) => void;\r\n  t: (key: string, vars?: Record<string, any>) => string;\r\n};\r\n\r\nconst I18nCtx = createContext<I18nCtxType | null>(null);\r\n\r\nexport function I18nProvider({ children }: { children: React.ReactNode }) {\r\n  // Se não for usar troca de idioma agora, deixe fixo em 'pt-BR'\r\n  const [locale, setLocaleState] = useState<Locale>(\"pt-BR\");\r\n\r\n  // Mantém o atributo lang coerente (não é obrigatório, mas ajuda em SEO/acessibilidade)\r\n  useEffect(() => {\r\n    document.documentElement.setAttribute(\"lang\", locale);\r\n  }, [locale]);\r\n\r\n  // Exponho setLocale para compatibilidade futura (hoje pode ficar sem uso)\r\n  const setLocale = (l: Locale) => {\r\n    setLocaleState(l);\r\n  };\r\n\r\n  // Tradutor com fallback para pt-BR e, por fim, a própria chave\r\n  const t = useMemo(() => {\r\n    return (key: string, vars?: Record<string, any>) => {\r\n      const dict = dictionaries[locale] || ptBR;\r\n      const entry = dict[key];\r\n      if (typeof entry === \"function\") return (entry as any)(vars || {});\r\n      if (typeof entry === \"string\") return entry;\r\n\r\n      const fb = ptBR[key];\r\n      if (typeof fb === \"function\") return (fb as any)(vars || {});\r\n      if (typeof fb === \"string\") return fb;\r\n\r\n      return key;\r\n    };\r\n  }, [locale]);\r\n\r\n  const value = useMemo(() => ({ locale, setLocale, t }), [locale, t]);\r\n\r\n  return <I18nCtx.Provider value={value}>{children}</I18nCtx.Provider>;\r\n}\r\n\r\nexport function useI18n() {\r\n  const ctx = useContext(I18nCtx);\r\n  if (!ctx) throw new Error(\"useI18n must be used within I18nProvider\");\r\n  return ctx;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 577, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/shell/AppShell.tsx"],"sourcesContent":["// src/components/shell/AppShell.tsx\r\n\"use client\";\r\n\r\nimport { ReactNode, useEffect, useState, Fragment } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport Sidebar from \"@/components/Sidebar\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport { I18nProvider } from \"@/components/I18nProvider\";\r\nimport { Menu as UiMenu, Transition } from \"@headlessui/react\";\r\nimport clsx from \"clsx\";\r\nimport { Menu, ShieldCheck, LogOut } from \"lucide-react\";\r\n\r\n/** Mapeia pathname -> título do header */\r\nconst titleMap: Record<string, string> = {\r\n  \"/me\": \"Meu Painel\",\r\n  \"/ranking\": \"Ranking\",\r\n  \"/config\": \"Configurações\",\r\n  \"/me/security\": \"Segurança\",\r\n  \"/admin/courses\": \"Administração\",\r\n};\r\n\r\nexport default function AppShell({ children }: { children: ReactNode }) {\r\n  /** layout */\r\n  const [open, setOpen] = useState(true); // desktop: aberta/rail\r\n  const [mobileOpen, setMobileOpen] = useState(false);\r\n\r\n  /** usuário */\r\n  const [displayName, setDisplayName] = useState<string | null>(null);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n\r\n  useEffect(() => {\r\n    const supabase = supabaseBrowser();\r\n    supabase.auth.getUser().then(async ({ data }) => {\r\n      const u = data.user;\r\n      if (!u) {\r\n        setIsAdmin(false);\r\n        setDisplayName(null);\r\n        return;\r\n      }\r\n      const { data: prof } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"is_admin, full_name, name\")\r\n        .eq(\"id\", u.id)\r\n        .single();\r\n      setIsAdmin(!!prof?.is_admin);\r\n      const name =\r\n        (prof?.full_name && String(prof.full_name).trim()) ||\r\n        (prof?.name && String(prof.name).trim()) ||\r\n        u.email ||\r\n        null;\r\n      setDisplayName(name);\r\n    });\r\n  }, []);\r\n\r\n  async function signOut() {\r\n    const supabase = supabaseBrowser();\r\n    await supabase.auth.signOut();\r\n    router.replace(\"/login\");\r\n  }\r\n\r\n  function handleNavigate() {\r\n    setMobileOpen(false);\r\n  }\r\n\r\n  const desktopCol = open ? \"18rem\" : \"4rem\";\r\n  const headerTitle =\r\n    titleMap[pathname] ??\r\n    (pathname?.startsWith(\"/u/\") ? \"Perfil\" : \"EstudoRank\");\r\n\r\n  const initial =\r\n    (displayName?.trim()?.charAt(0)?.toUpperCase() as string) || \"U\";\r\n\r\n  return (\r\n    <I18nProvider>\r\n      <div\r\n        className=\"min-h-screen w-full grid\"\r\n        style={{ gridTemplateColumns: `${desktopCol} 1fr` }}\r\n      >\r\n        {/* Sidebar Desktop */}\r\n        <div className=\"hidden lg:block border-r border-white/10 bg-[var(--surface)]/70 backdrop-blur-xl\">\r\n          <Sidebar isAdmin={isAdmin} collapsed={!open} />\r\n        </div>\r\n\r\n        {/* Conteúdo */}\r\n        <div className=\"min-h-screen flex flex-col\">\r\n          {/* Topbar */}\r\n          <header className=\"sticky top-0 z-30 h-14 border-b border-white/10 bg-[var(--surface)]/70 backdrop-blur flex items-center justify-between px-3 sm:px-4 lg:px-6\">\r\n            <div className=\"flex items-center gap-2\">\r\n              {/* Toggle Mobile Drawer */}\r\n              <button\r\n                className=\"btn-icon lg:hidden\"\r\n                onClick={() => setMobileOpen(true)}\r\n                aria-label=\"Abrir menu\"\r\n              >\r\n                <Menu size={18} />\r\n              </button>\r\n\r\n              {/* Toggle largura sidebar (desktop) */}\r\n              <button\r\n                className=\"btn-icon hidden lg:inline-flex\"\r\n                onClick={() => setOpen((v) => !v)}\r\n                aria-label={open ? \"Recolher menu\" : \"Expandir menu\"}\r\n                title={open ? \"Recolher menu\" : \"Expandir menu\"}\r\n              >\r\n                <Menu size={18} />\r\n              </button>\r\n\r\n              {/* Título da página */}\r\n              <span className=\"text-sm opacity-90 font-medium\">\r\n                {headerTitle}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Menu do usuário (apenas Administração + Sair) */}\r\n            <UiMenu as=\"div\" className=\"relative\">\r\n              <UiMenu.Button className=\"inline-flex items-center gap-2 rounded-lg border border-white/10 bg-white/5 px-2.5 h-9 hover:bg-white/10 transition\">\r\n                <span className=\"inline-grid place-items-center h-6 w-6 rounded-full bg-white/10 border border-white/15 text-xs\">\r\n                  {initial}\r\n                </span>\r\n                <span className=\"max-w-[160px] truncate text-sm\">\r\n                  {displayName ?? \"Conta\"}\r\n                </span>\r\n                <svg\r\n                  aria-hidden\r\n                  width=\"16\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  className=\"opacity-70\"\r\n                >\r\n                  <path\r\n                    fill=\"currentColor\"\r\n                    d=\"M7 10l5 5 5-5z\"\r\n                  />\r\n                </svg>\r\n              </UiMenu.Button>\r\n\r\n              <Transition\r\n                as={Fragment}\r\n                enter=\"transition ease-out duration-120\"\r\n                enterFrom=\"opacity-0 translate-y-1\"\r\n                enterTo=\"opacity-100 translate-y-0\"\r\n                leave=\"transition ease-in duration-100\"\r\n                leaveFrom=\"opacity-100 translate-y-0\"\r\n                leaveTo=\"opacity-0 translate-y-1\"\r\n              >\r\n                <UiMenu.Items className=\"absolute right-0 mt-2 w-56 origin-top-right rounded-xl border border-white/10 bg-[var(--surface)]/98 backdrop-blur shadow-2xl focus:outline-none p-1\">\r\n                  {isAdmin && (\r\n                    <UiMenu.Item>\r\n                      {({ active }) => (\r\n                        <Link\r\n                          href=\"/admin/courses\"\r\n                          className={clsx(\r\n                            \"flex items-center gap-2 rounded-lg px-3 py-2 text-sm\",\r\n                            active ? \"bg-white/10\" : \"bg-transparent\"\r\n                          )}\r\n                        >\r\n                          <ShieldCheck size={16} className=\"text-lime-300\" />\r\n                          Administração\r\n                        </Link>\r\n                      )}\r\n                    </UiMenu.Item>\r\n                  )}\r\n\r\n                  <div className=\"my-1 h-px bg-white/10\" />\r\n\r\n                  <UiMenu.Item>\r\n                    {({ active }) => (\r\n                      <button\r\n                        onClick={signOut}\r\n                        className={clsx(\r\n                          \"w-full flex items-center gap-2 rounded-lg px-3 py-2 text-left text-sm\",\r\n                          active ? \"bg-white/10\" : \"bg-transparent\"\r\n                        )}\r\n                      >\r\n                        <LogOut size={16} />\r\n                        Sair\r\n                      </button>\r\n                    )}\r\n                  </UiMenu.Item>\r\n                </UiMenu.Items>\r\n              </Transition>\r\n            </UiMenu>\r\n          </header>\r\n\r\n          <main className=\"flex-1 p-4 sm:p-6 lg:p-8\">{children}</main>\r\n        </div>\r\n\r\n        {/* Drawer Mobile */}\r\n        {mobileOpen && (\r\n          <div className=\"lg:hidden fixed inset-0 z-40\">\r\n            {/* overlay */}\r\n            <button\r\n              className=\"absolute inset-0 bg-black/50\"\r\n              onClick={() => setMobileOpen(false)}\r\n              aria-label=\"Fechar menu\"\r\n            />\r\n            <div className=\"absolute left-0 top-0 h-full w-72 bg-[var(--surface)]/90 border-r border-white/10 shadow-xl\">\r\n              <Sidebar isAdmin={isAdmin} onNavigate={handleNavigate} />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </I18nProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 953, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/components/chat/ChatDock.tsx"],"sourcesContent":["// src/components/chat/ChatDock.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useRef, useState, useCallback } from \"react\";\r\nimport { SendHorizontal, MessageSquareText } from \"lucide-react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\ntype DbMessage = {\r\n  id: string;\r\n  user_id: string | null;\r\n  channel: string;\r\n  content: string;\r\n  created_at: string;\r\n  client_msg_id?: string | null;\r\n};\r\n\r\ntype Profile = {\r\n  id: string;\r\n  full_name: string | null;\r\n  name?: string | null;\r\n};\r\n\r\ntype Props = {\r\n  channel: string;                     // ex.: \"ranking-global\"\r\n  height?: string;                     // ex.: \"clamp(420px,70vh,720px)\"\r\n};\r\n\r\nexport default function ChatDock({\r\n  channel,\r\n  height = \"clamp(420px, 70vh, 720px)\",\r\n}: Props) {\r\n  const supabase = useMemo(() => supabaseBrowser(), []);\r\n\r\n  const [me, setMe] = useState<string | null>(null);\r\n  const [text, setText] = useState(\"\");\r\n  const [sending, setSending] = useState(false);\r\n  const [messages, setMessages] = useState<DbMessage[]>([]);\r\n  const [names, setNames] = useState<Record<string, string>>({});\r\n\r\n  // Dedupe\r\n  const seenIds = useRef<Set<string>>(new Set());\r\n  const seenClientIds = useRef<Set<string>>(new Set());\r\n\r\n  const listRef = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const fmt = useMemo(\r\n    () => new Intl.DateTimeFormat(undefined, { hour: \"2-digit\", minute: \"2-digit\" }),\r\n    []\r\n  );\r\n\r\n  const scrollToBottom = useCallback((behavior: ScrollBehavior = \"smooth\") => {\r\n    const el = listRef.current;\r\n    if (!el) return;\r\n    el.scrollTo({ top: el.scrollHeight, behavior });\r\n  }, []);\r\n\r\n  /* -------- carga inicial -------- */\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    (async () => {\r\n      const { data: u } = await supabase.auth.getUser();\r\n      const uid = u.user?.id ?? null;\r\n      if (!cancelled) setMe(uid);\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"messages\")\r\n        .select(\"*\")\r\n        .eq(\"channel\", channel)\r\n        .order(\"created_at\", { ascending: true })\r\n        .limit(200);\r\n\r\n      if (error) {\r\n        console.error(\"[ChatDock] load error:\", error);\r\n        return;\r\n      }\r\n\r\n      const list = (data as DbMessage[]) || [];\r\n      for (const m of list) {\r\n        if (m?.id) seenIds.current.add(String(m.id));\r\n        if (m?.client_msg_id) seenClientIds.current.add(String(m.client_msg_id));\r\n      }\r\n\r\n      if (!cancelled) {\r\n        setMessages(list);\r\n\r\n        // nomes\r\n        const ids = Array.from(new Set(list.map((m) => m.user_id).filter(Boolean))) as string[];\r\n        if (ids.length) {\r\n          const { data: profs } = await supabase\r\n            .from(\"profiles\")\r\n            .select(\"id, full_name, name\")\r\n            .in(\"id\", ids);\r\n\r\n          const map: Record<string, string> = {};\r\n          (profs as Profile[] | null)?.forEach((p) => {\r\n            map[p.id] =\r\n              (p.full_name && p.full_name.trim()) ||\r\n              (p.name && p.name.trim()) ||\r\n              \"Usuário\";\r\n          });\r\n          setNames(map);\r\n        }\r\n\r\n        setTimeout(() => inputRef.current?.focus(), 60);\r\n        setTimeout(() => scrollToBottom(\"auto\"), 0); // desce na 1a carga\r\n      }\r\n    })();\r\n    return () => { cancelled = true; };\r\n  }, [channel, supabase, scrollToBottom]);\r\n\r\n  /* -------- realtime sempre com auto-scroll -------- */\r\n  useEffect(() => {\r\n    const ch = supabase\r\n      .channel(`chat:${channel}`)\r\n      .on(\r\n        \"postgres_changes\",\r\n        { event: \"INSERT\", schema: \"public\", table: \"messages\", filter: `channel=eq.${channel}` },\r\n        async (payload) => {\r\n          const m = payload.new as DbMessage;\r\n\r\n          // dedupe\r\n          if (m?.id && seenIds.current.has(String(m.id))) return;\r\n          if (m?.client_msg_id && seenClientIds.current.has(String(m.client_msg_id))) return;\r\n          if (m?.id) seenIds.current.add(String(m.id));\r\n          if (m?.client_msg_id) seenClientIds.current.add(String(m.client_msg_id));\r\n\r\n          setMessages((cur) => [...cur, m]);\r\n\r\n          // nome do autor se faltando\r\n          if (m.user_id && !names[m.user_id]) {\r\n            const { data: p } = await supabase\r\n              .from(\"profiles\")\r\n              .select(\"id, full_name, name\")\r\n              .eq(\"id\", m.user_id)\r\n              .single();\r\n            if (p) {\r\n              setNames((old) => ({\r\n                ...old,\r\n                [p.id]:\r\n                  (p.full_name && p.full_name.trim()) ||\r\n                  (p.name && p.name.trim()) ||\r\n                  \"Usuário\",\r\n              }));\r\n            }\r\n          }\r\n\r\n          // 👇 sempre desce quando chega nova mensagem (estilo WhatsApp auto)\r\n          setTimeout(() => scrollToBottom(\"smooth\"), 0);\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => { supabase.removeChannel(ch); };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [channel, supabase, names, scrollToBottom]);\r\n\r\n  /* -------- desce sempre que o array cresce -------- */\r\n  useEffect(() => {\r\n    scrollToBottom(\"smooth\");\r\n  }, [messages.length, scrollToBottom]);\r\n\r\n  /* -------- enviar -------- */\r\n  async function send() {\r\n    const content = text.trim();\r\n    if (!content || !me) return;\r\n    if (content.length > 800) return;\r\n\r\n    setSending(true);\r\n    const clientId = crypto.randomUUID();\r\n    try {\r\n      setText(\"\");\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"messages\")\r\n        .insert({\r\n          user_id: me,\r\n          channel,\r\n          content,\r\n          client_msg_id: clientId, // comente se não tiver a coluna\r\n        })\r\n        .select(\"*\")\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error(\"[ChatDock] insert error:\", error);\r\n        setText(content);\r\n        return;\r\n      }\r\n\r\n      if (data?.id) seenIds.current.add(String(data.id));\r\n      if (clientId) seenClientIds.current.add(clientId);\r\n\r\n      const row = data as DbMessage;\r\n      setMessages((cur) => [...cur, row]);\r\n      setTimeout(() => scrollToBottom(\"smooth\"), 0);\r\n    } catch (err) {\r\n      console.error(\"[ChatDock] unexpected send error:\", err);\r\n      setText(content);\r\n    } finally {\r\n      setSending(false);\r\n      setTimeout(() => inputRef.current?.focus(), 10);\r\n    }\r\n  }\r\n\r\n  function onKeyDown(e: React.KeyboardEvent<HTMLInputElement>) {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      if (!sending) send();\r\n    }\r\n  }\r\n\r\n  /* -------- animação das mensagens -------- */\r\n  const itemVariants = {\r\n    hidden: { opacity: 0, y: 6, filter: \"blur(2px)\" },\r\n    show:   { opacity: 1, y: 0, filter: \"blur(0px)\", transition: { duration: 0.16, ease: \"easeOut\" } },\r\n    exit:   { opacity: 0, y: -6, filter: \"blur(2px)\", transition: { duration: 0.12, ease: \"easeIn\" } },\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"relative rounded-2xl border border-white/10 bg-[var(--surface)]/70 backdrop-blur-md shadow-xl overflow-hidden flex flex-col min-h-0\"\r\n      style={{ height }}\r\n      aria-label=\"Chat do Ranking\"\r\n    >\r\n      {/* Header */}\r\n      <div className=\"h-11 px-3 flex items-center justify-between border-b border-white/10 flex-shrink-0\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"inline-flex w-2 h-2 rounded-full bg-[var(--accent)] animate-pulse\" />\r\n          <span className=\"font-medium text-sm\">Chat do Ranking</span>\r\n        </div>\r\n        <div className=\"text-[11px] opacity-70 flex items-center gap-1\">\r\n          <MessageSquareText size={14} aria-hidden=\"true\" />\r\n          {messages.length}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Lista (scroll invisível) */}\r\n      <div\r\n        ref={listRef}\r\n        className=\"flex-1 min-h-0 overflow-y-auto p-3 space-y-1.5 no-scrollbar\"\r\n        role=\"log\"\r\n        aria-live=\"polite\"\r\n        aria-relevant=\"additions\"\r\n      >\r\n        <AnimatePresence initial={false}>\r\n          {messages.map((m, i) => {\r\n            const mine = m.user_id === me;\r\n            const name =\r\n              (m.user_id && names[m.user_id]) ||\r\n              (mine ? \"Você\" : m.user_id ? `Usuário ${m.user_id.slice(0, 4)}` : \"Usuário\");\r\n            const prev = messages[i - 1];\r\n            const sameAsPrev = prev && prev.user_id === m.user_id;\r\n            const time = fmt.format(new Date(m.created_at));\r\n\r\n            return (\r\n              <motion.div\r\n                key={m.id}\r\n                variants={itemVariants}\r\n                initial=\"hidden\"\r\n                animate=\"show\"\r\n                exit=\"exit\"\r\n                layout\r\n                className={`flex ${mine ? \"justify-end\" : \"justify-start\"}`}\r\n              >\r\n                {!mine && !sameAsPrev && (\r\n                  <div className=\"mr-2 mt-5 flex-shrink-0\">\r\n                    <div className=\"w-6 h-6 rounded-full bg-white/10 grid place-items-center text-[11px]\">\r\n                      {(name?.[0] || \"U\").toUpperCase()}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"max-w-full flex flex-col items-start\">\r\n                  {!mine && !sameAsPrev && (\r\n                    <motion.div layout className=\"text-[11px] font-medium mb-1 ml-1 opacity-60\">\r\n                      {name}\r\n                    </motion.div>\r\n                  )}\r\n\r\n                  <motion.div\r\n                    layout\r\n                    className={[\r\n                      \"max-w-[100%] md:max-w-[100%]\",\r\n                      \"px-3 py-1.5 rounded-2xl text-[13px] leading-snug\",\r\n                      \"shadow-[0_1px_3px_rgba(0,0,0,0.25)]\",\r\n                      mine\r\n                        ? \"self-end bg-gradient-to-r from-[#A3E635]/90 to-[#84CC16]/80 text-black rounded-br-sm\"\r\n                        : \"self-start bg-gradient-to-r from-white/10 to-white/5 text-white rounded-bl-sm\",\r\n                    ].join(\" \")}\r\n                  >\r\n                    <div className=\"whitespace-pre-line break-words\">{m.content}</div>\r\n                  </motion.div>\r\n\r\n                  <motion.div\r\n                    layout\r\n                    className={`text-[10px] mt-[2px] ${\r\n                      mine ? \"self-end pr-1 text-white/40\" : \"self-start pl-1 text-white/40\"\r\n                    }`}\r\n                  >\r\n                    {time}\r\n                  </motion.div>\r\n                </div>\r\n              </motion.div>\r\n            );\r\n          })}\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      {/* Composer */}\r\n      <div className=\"h-14 border-t border-white/10 px-2 sm:px-3 flex items-center gap-2 flex-shrink-0\">\r\n        <input\r\n          ref={inputRef}\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n          onKeyDown={onKeyDown}\r\n          placeholder=\"Escreva uma mensagem…\"\r\n          className=\"flex-1 h-9 px-3 rounded-full bg-white/5 border border-white/10 outline-none focus:ring-2 focus:ring-white/20 text-[13px] placeholder:opacity-60\"\r\n          maxLength={800}\r\n          aria-label=\"Escreva uma mensagem\"\r\n        />\r\n        <button\r\n          type=\"button\"\r\n          onClick={send}\r\n          disabled={!text.trim() || sending}\r\n          className=\"h-9 min-w-[84px] inline-flex items-center justify-center gap-2 rounded-full px-3 bg-white/10 hover:bg-white/20 disabled:opacity-60 transition\"\r\n        >\r\n          <SendHorizontal size={16} aria-hidden=\"true\" />\r\n          <span className=\"text-sm\">Enviar</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1425, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/adsli/EstudoRank-patched-2025-10-22/estudorank/src/app/ranking/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport AuthGuard from \"@/components/AuthGuard\";\r\nimport AppShell from \"@/components/shell/AppShell\";\r\nimport { motion } from \"framer-motion\";\r\nimport {\r\n  Trophy,\r\n  Medal,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  RefreshCw,\r\n  Search,\r\n  MessageSquare,\r\n  X,\r\n} from \"lucide-react\";\r\nimport { supabaseBrowser } from \"@/lib/supabase/client\";\r\nimport ChatDock from \"@/components/chat/ChatDock\";\r\n\r\ntype Item = {\r\n  user_id: string;\r\n  name?: string | null;\r\n  email?: string | null;\r\n  points: number;\r\n  total: number;\r\n};\r\n\r\ntype ApiResp = {\r\n  ok: boolean;\r\n  leaderboard: Item[];\r\n  page: number;\r\n  pageSize: number;\r\n  total: number;\r\n  pages: number;\r\n  via?: string;\r\n  adminClient?: boolean;\r\n  error?: string;\r\n};\r\n\r\nfunction Pill({ children }: { children: React.ReactNode }) {\r\n  return (\r\n    <span className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs bg-white/5 border border-white/10 text-white/80\">\r\n      {children}\r\n    </span>\r\n  );\r\n}\r\n\r\nfunction SkeletonRow() {\r\n  return (\r\n    <div className=\"grid grid-cols-[72px,1fr,220px,120px] md:grid-cols-[80px,1fr,260px,130px] gap-3 px-5 py-4 animate-pulse\">\r\n      <div className=\"h-4 w-10 rounded bg-white/10\" />\r\n      <div className=\"h-4 w-48 rounded bg-white/10\" />\r\n      <div className=\"h-2.5 w-40 rounded bg-white/10 self-center\" />\r\n      <div className=\"h-4 w-14 rounded bg-white/10 justify-self-end\" />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction RelativeBar({ value, max }: { value: number; max: number }) {\r\n  const pct = max > 0 ? Math.round((value / max) * 100) : 0;\r\n  return (\r\n    <div className=\"w-full h-2.5 rounded-full bg-white/8 overflow-hidden\">\r\n      <div className=\"h-full bg-lime-400/80\" style={{ width: `${pct}%` }} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function RankingPage() {\r\n  return (\r\n    <AuthGuard>\r\n      <AppShell>\r\n        <Content />\r\n      </AppShell>\r\n    </AuthGuard>\r\n  );\r\n}\r\n\r\nfunction Content() {\r\n  const [data, setData] = useState<Item[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [err, setErr] = useState<string | null>(null);\r\n  const [page, setPage] = useState(1);\r\n  const [pages, setPages] = useState(1);\r\n  const [total, setTotal] = useState(0);\r\n  const [pageSize] = useState(25);\r\n  const [lastUpdate, setLastUpdate] = useState<Date | null>(null);\r\n\r\n  const [q, setQ] = useState(\"\");\r\n  const [orderDesc, setOrderDesc] = useState(true);\r\n\r\n  const [chatOpen, setChatOpen] = useState(false);\r\n\r\n  const [meId, setMeId] = useState<string | null>(null);\r\n  useEffect(() => {\r\n    const sb = supabaseBrowser();\r\n    sb.auth.getUser().then(({ data }) => setMeId(data.user?.id ?? null));\r\n  }, []);\r\n\r\n  async function load(p = page) {\r\n    try {\r\n      setLoading(true);\r\n      setErr(null);\r\n      const res = await fetch(`/api/ranking?page=${p}&pageSize=${pageSize}`, {\r\n        cache: \"no-store\",\r\n      });\r\n      const json: ApiResp = await res.json();\r\n      if (!res.ok || !json.ok) throw new Error(json?.error || \"Erro ao carregar ranking\");\r\n      setData(json.leaderboard || []);\r\n      setPages(json.pages || 1);\r\n      setTotal(json.total || 0);\r\n      setLastUpdate(new Date());\r\n    } catch (e: any) {\r\n      setErr(e.message || \"Falha ao carregar\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    load(1);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const { filtered, maxPoints } = useMemo(() => {\r\n    const arr = (data || []).filter((it) => {\r\n      const cand = `${it.name ?? \"\"} ${it.email ?? \"\"}`.toLowerCase();\r\n      return q.trim() ? cand.includes(q.trim().toLowerCase()) : true;\r\n    });\r\n    arr.sort((a, b) => (orderDesc ? b.points - a.points : a.points - b.points));\r\n    const max = arr.reduce((m, it) => Math.max(m, it.points), 0);\r\n    return { filtered: arr, maxPoints: max };\r\n  }, [data, q, orderDesc]);\r\n\r\n  const updatedText = useMemo(() => {\r\n    if (!lastUpdate) return \"—\";\r\n    const diff = Math.floor((Date.now() - lastUpdate.getTime()) / 1000);\r\n    if (diff < 5) return \"Atualizado agora\";\r\n    if (diff < 60) return `Há ${diff}s`;\r\n    const m = Math.floor(diff / 60);\r\n    return `Há ${m}min`;\r\n  }, [lastUpdate]);\r\n\r\n  return (\r\n    <div className=\"max-w-[1200px] mx-auto px-5 md:px-8 py-8 md:py-10\">\r\n      <motion.div\r\n        initial={{ opacity: 0, y: 8 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"relative overflow-hidden rounded-2xl p-6 bg-gradient-to-b from-neutral-900 to-black shadow-[inset_0_0_0_1px_rgba(255,255,255,0.05)]\"\r\n      >\r\n        <div className=\"flex items-center justify-between gap-3 flex-wrap\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"rounded-xl bg-white/10 p-3\">\r\n              <Trophy size={22} className=\"text-lime-300\" />\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xl font-semibold\">Ranking Geral</div>\r\n              <div className=\"text-sm text-white/70\">Veja quem está subindo no topo</div>\r\n            </div>\r\n          </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n            <Pill>{updatedText}</Pill>\r\n            <Pill>{total} participantes</Pill>\r\n            <button\r\n              onClick={() => load(page)}\r\n              className=\"ml-1 inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-white/10 hover:bg-white/15 border border-white/10\"\r\n              aria-label=\"Atualizar ranking\"\r\n            >\r\n              <RefreshCw size={16} className={loading ? \"animate-spin\" : \"\"} />\r\n              Atualizar\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => setChatOpen(true)}\r\n              className=\"md:hidden inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-white/10 hover:bg-white/15 border border-white/10\"\r\n              aria-label=\"Abrir chat\"\r\n            >\r\n              <MessageSquare size={16} />\r\n              Chat\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-4 flex flex-col md:flex-row gap-3\">\r\n          <label className=\"relative flex-1\">\r\n            <Search size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-white/40\" />\r\n            <input\r\n              value={q}\r\n              onChange={(e) => setQ(e.target.value)}\r\n              placeholder=\"Buscar usuário…\"\r\n              className=\"w-full pl-9 pr-3 py-2 rounded-lg bg-white/5 border border-white/10 outline-none focus:border-white/20\"\r\n              aria-label=\"Buscar no ranking\"\r\n            />\r\n          </label>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <button\r\n              onClick={() => setOrderDesc((v) => !v)}\r\n              className=\"px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-sm hover:bg-white/10\"\r\n              title=\"Alternar ordenação\"\r\n            >\r\n              Ordenar por pontos {orderDesc ? \"↓\" : \"↑\"}\r\n            </button>\r\n\r\n            <div className=\"flex items-center\">\r\n              <button\r\n                onClick={() => {\r\n                  const p = Math.max(1, page - 1);\r\n                  setPage(p);\r\n                  load(p);\r\n                }}\r\n                disabled={page <= 1 || loading}\r\n                className=\"px-2 py-2 rounded-l-lg bg-white/5 border border-white/10 hover:bg-white/10 disabled:opacity-40\"\r\n                aria-label=\"Página anterior\"\r\n              >\r\n                <ChevronLeft size={16} />\r\n              </button>\r\n              <div className=\"px-3 py-2 text-sm bg-white/5 border-t border-b border-white/10\">\r\n                {page}/{pages}\r\n              </div>\r\n              <button\r\n                onClick={() => {\r\n                  const p = Math.min(pages, page + 1);\r\n                  setPage(p);\r\n                  load(p);\r\n                }}\r\n                disabled={page >= pages || loading}\r\n                className=\"px-2 py-2 rounded-r-lg bg-white/5 border border-white/10 hover:bg-white/10 disabled:opacity-40\"\r\n                aria-label=\"Próxima página\"\r\n              >\r\n                <ChevronRight size={16} />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </motion.div>\r\n\r\n      <div className=\"mt-6 grid md:grid-cols-[1fr,380px] gap-6\">\r\n        <div className=\"rounded-2xl overflow-hidden bg-white/[0.03] border border-white/10\">\r\n          <div className=\"sticky top-0 z-10 grid grid-cols-[72px,1fr,220px,120px] md:grid-cols-[80px,1fr,260px,130px] gap-3 px-5 py-3 text-xs uppercase tracking-wide text-white/60 border-b border-white/10 bg-black/60 backdrop-blur\">\r\n            <div>Posição</div>\r\n            <div>Usuário</div>\r\n            <div>Progresso relativo</div>\r\n            <div className=\"justify-self-end\">Pontos</div>\r\n          </div>\r\n\r\n          {err ? (\r\n            <div className=\"p-6 text-sm text-red-300\">\r\n              {err}{\" \"}\r\n              <button onClick={() => load(page)} className=\"underline decoration-dotted ml-2\">\r\n                Tentar novamente\r\n              </button>\r\n            </div>\r\n          ) : loading ? (\r\n            <div className=\"divide-y divide-white/10\">\r\n              {Array.from({ length: 8 }).map((_, i) => (\r\n                <SkeletonRow key={i} />\r\n              ))}\r\n            </div>\r\n          ) : filtered.length === 0 ? (\r\n            <div className=\"p-8 text-sm text-white/70\">Nenhum participante encontrado.</div>\r\n          ) : (\r\n            <div className=\"divide-y divide-white/10\">\r\n              {filtered.map((it, idx) => {\r\n                const pos = (page - 1) * pageSize + (idx + 1);\r\n                const showMedal = pos <= 3;\r\n                const isMe = meId && it.user_id === meId;\r\n                const label = it.name || it.email || \"Usuário\";\r\n\r\n                // 👇 Passa nome e email como hints para o perfil (fallback)\r\n                const href = `/u/${encodeURIComponent(it.user_id)}?n=${encodeURIComponent(\r\n                  label\r\n                )}${it.email ? `&e=${encodeURIComponent(it.email)}` : \"\"}`;\r\n\r\n                return (\r\n                  <Link\r\n                    href={href}\r\n                    key={`${it.user_id}-${pos}`}\r\n                    className={`grid grid-cols-[72px,1fr,220px,120px] md:grid-cols-[80px,1fr,260px,130px] gap-3 px-5 py-4 transition-colors hover:bg-white/[0.04] focus:outline-none focus:ring-2 focus:ring-lime-400/30 ${\r\n                      isMe ? \"bg-lime-400/[0.06]\" : \"\"\r\n                    }`}\r\n                    aria-label={`Abrir perfil de ${label}`}\r\n                  >\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {showMedal ? (\r\n                        <Medal\r\n                          size={18}\r\n                          className={\r\n                            pos === 1\r\n                              ? \"text-yellow-300\"\r\n                              : pos === 2\r\n                              ? \"text-slate-300\"\r\n                              : \"text-amber-600\"\r\n                          }\r\n                          aria-hidden\r\n                        />\r\n                      ) : (\r\n                        <span className=\"w-5 text-right opacity-70\">{pos}</span>\r\n                      )}\r\n                      <span className=\"sr-only\">Posição {pos}</span>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3 min-w-0\">\r\n                      <div className=\"h-8 w-8 rounded-full bg-white/10 flex items-center justify-center text-xs text-white/70 border border-white/10\">\r\n                        {(label || \"U\").slice(0, 1).toUpperCase()}\r\n                      </div>\r\n                      <div className=\"truncate\">\r\n                        <div className=\"font-medium text-white/90 truncate flex items-center gap-2\">\r\n                          <span className=\"truncate\">{label}</span>\r\n                          {/* {isMe && (\r\n                            <span className=\"text-[10px] px-1.5 py-0.5 rounded bg-lime-400/10 text-lime-300 border border-lime-400/30\">\r\n                              você\r\n                            </span>\r\n                          )} */}\r\n                        </div>\r\n                        <div className=\"text-xs text-white/50 truncate\">\r\n                          {it.email || \"—\"}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3 self-center\">\r\n                      <RelativeBar value={it.points} max={maxPoints} />\r\n                    </div>\r\n\r\n                    <div className=\"justify-self-end font-semibold text-white/90\">\r\n                      {it.points.toLocaleString(\"pt-BR\")}\r\n                    </div>\r\n                  </Link>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <aside className=\"hidden md:block rounded-2xl overflow-hidden bg-white/[0.03] border border-white/10\">\r\n          <div className=\"px-5 py-3 border-b border-white/10 flex items-center justify-between\">\r\n            <div className=\"font-medium\">Chat do Ranking</div>\r\n            <Pill>canal: ranking-global</Pill>\r\n          </div>\r\n          <div className=\"h-[560px]\">\r\n            <ChatDock channel=\"ranking-global\" height=\"560px\" />\r\n          </div>\r\n        </aside>\r\n      </div>\r\n\r\n      {chatOpen && (\r\n        <div className=\"fixed inset-0 z-50\">\r\n          <div\r\n            className=\"absolute inset-0 bg-black/60\"\r\n            onClick={() => setChatOpen(false)}\r\n            aria-hidden\r\n          />\r\n          <div className=\"absolute bottom-0 left-0 right-0 rounded-t-2xl bg-neutral-900 border-t border-white/10 shadow-2xl\">\r\n            <div className=\"px-5 py-3 flex items-center justify-between border-b border-white/10\">\r\n              <div className=\"font-medium\">Chat do Ranking</div>\r\n              <button\r\n                className=\"p-2 rounded-lg bg-white/5 hover:bg-white/10\"\r\n                onClick={() => setChatOpen(false)}\r\n                aria-label=\"Fechar chat\"\r\n              >\r\n                <X size={18} />\r\n              </button>\r\n            </div>\r\n            <div className=\"h-[70vh]\">\r\n              <ChatDock channel=\"ranking-global\" height=\"70vh\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;;;AAlBA;;;;;;;;;AAwCA,SAAS,KAAK,KAA2C;QAA3C,EAAE,QAAQ,EAAiC,GAA3C;IACZ,qBACE,6LAAC;QAAK,WAAU;kBACb;;;;;;AAGP;KANS;AAQT,SAAS;IACP,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;;;;;;;AAGrB;MATS;AAWT,SAAS,YAAY,KAA8C;QAA9C,EAAE,KAAK,EAAE,GAAG,EAAkC,GAA9C;IACnB,MAAM,MAAM,MAAM,IAAI,KAAK,KAAK,CAAC,AAAC,QAAQ,MAAO,OAAO;IACxD,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;YAAwB,OAAO;gBAAE,OAAO,AAAC,GAAM,OAAJ,KAAI;YAAG;;;;;;;;;;;AAGvE;MAPS;AASM,SAAS;IACtB,qBACE,6LAAC,6IAAS;kBACR,cAAA,6LAAC,qJAAQ;sBACP,cAAA,6LAAC;;;;;;;;;;;;;;;AAIT;MARwB;AAUxB,SAAS;;IACP,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAS,EAAE;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAgB;IAC9C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,GAAG,IAAA,yKAAQ,EAAC;IAC5B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAc;IAE1D,MAAM,CAAC,GAAG,KAAK,GAAG,IAAA,yKAAQ,EAAC;IAC3B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAgB;IAChD,IAAA,0KAAS;6BAAC;YACR,MAAM,KAAK,IAAA,sJAAe;YAC1B,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI;qCAAC;wBAAC,EAAE,IAAI,EAAE;wBAAa;wBAAA;2BAAR,QAAQ,CAAA,iBAAA,aAAA,KAAK,IAAI,cAAT,iCAAA,WAAW,EAAE,cAAb,2BAAA,gBAAiB;;;QAChE;4BAAG,EAAE;IAEL,eAAe;YAAK,IAAA,iEAAI;QACtB,IAAI;YACF,WAAW;YACX,OAAO;YACP,MAAM,MAAM,MAAM,MAAM,AAAC,qBAAkC,OAAd,GAAE,cAAqB,OAAT,WAAY;gBACrE,OAAO;YACT;YACA,MAAM,OAAgB,MAAM,IAAI,IAAI;YACpC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE,EAAE,MAAM,IAAI,MAAM,CAAA,iBAAA,2BAAA,KAAM,KAAK,KAAI;YACxD,QAAQ,KAAK,WAAW,IAAI,EAAE;YAC9B,SAAS,KAAK,KAAK,IAAI;YACvB,SAAS,KAAK,KAAK,IAAI;YACvB,cAAc,IAAI;QACpB,EAAE,OAAO,GAAQ;YACf,OAAO,EAAE,OAAO,IAAI;QACtB,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;6BAAC;YACR,KAAK;QACL,uDAAuD;QACzD;4BAAG,EAAE;IAEL,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG,IAAA,wKAAO;2BAAC;YACtC,MAAM,MAAM,CAAC,QAAQ,EAAE,EAAE,MAAM;uCAAC,CAAC;wBACf,UAAiB;oBAAjC,MAAM,OAAO,AAAC,GAAmB,OAAjB,CAAA,WAAA,GAAG,IAAI,cAAP,sBAAA,WAAW,IAAG,KAAkB,OAAf,CAAA,YAAA,GAAG,KAAK,cAAR,uBAAA,YAAY,IAAK,WAAW;oBAC7D,OAAO,EAAE,IAAI,KAAK,KAAK,QAAQ,CAAC,EAAE,IAAI,GAAG,WAAW,MAAM;gBAC5D;;YACA,IAAI,IAAI;mCAAC,CAAC,GAAG,IAAO,YAAY,EAAE,MAAM,GAAG,EAAE,MAAM,GAAG,EAAE,MAAM,GAAG,EAAE,MAAM;;YACzE,MAAM,MAAM,IAAI,MAAM;uCAAC,CAAC,GAAG,KAAO,KAAK,GAAG,CAAC,GAAG,GAAG,MAAM;sCAAG;YAC1D,OAAO;gBAAE,UAAU;gBAAK,WAAW;YAAI;QACzC;0BAAG;QAAC;QAAM;QAAG;KAAU;IAEvB,MAAM,cAAc,IAAA,wKAAO;wCAAC;YAC1B,IAAI,CAAC,YAAY,OAAO;YACxB,MAAM,OAAO,KAAK,KAAK,CAAC,CAAC,KAAK,GAAG,KAAK,WAAW,OAAO,EAAE,IAAI;YAC9D,IAAI,OAAO,GAAG,OAAO;YACrB,IAAI,OAAO,IAAI,OAAO,AAAC,MAAU,OAAL,MAAK;YACjC,MAAM,IAAI,KAAK,KAAK,CAAC,OAAO;YAC5B,OAAO,AAAC,MAAO,OAAF,GAAE;QACjB;uCAAG;QAAC;KAAW;IAEf,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,uMAAM,CAAC,GAAG;gBACT,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;gBAC5B,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;gBAC5B,WAAU;;kCAEV,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC,mNAAM;4CAAC,MAAM;4CAAI,WAAU;;;;;;;;;;;kDAE9B,6LAAC;;0DACC,6LAAC;gDAAI,WAAU;0DAAwB;;;;;;0DACvC,6LAAC;gDAAI,WAAU;0DAAwB;;;;;;;;;;;;;;;;;;0CAI7C,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;kDAAM;;;;;;kDACP,6LAAC;;4CAAM;4CAAM;;;;;;;kDACb,6LAAC;wCACC,SAAS,IAAM,KAAK;wCACpB,WAAU;wCACV,cAAW;;0DAEX,6LAAC,gOAAS;gDAAC,MAAM;gDAAI,WAAW,UAAU,iBAAiB;;;;;;4CAAM;;;;;;;kDAInE,6LAAC;wCACC,SAAS,IAAM,YAAY;wCAC3B,WAAU;wCACV,cAAW;;0DAEX,6LAAC,4OAAa;gDAAC,MAAM;;;;;;4CAAM;;;;;;;;;;;;;;;;;;;kCAMjC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAM,WAAU;;kDACf,6LAAC,mNAAM;wCAAC,MAAM;wCAAI,WAAU;;;;;;kDAC5B,6LAAC;wCACC,OAAO;wCACP,UAAU,CAAC,IAAM,KAAK,EAAE,MAAM,CAAC,KAAK;wCACpC,aAAY;wCACZ,WAAU;wCACV,cAAW;;;;;;;;;;;;0CAIf,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,SAAS,IAAM,aAAa,CAAC,IAAM,CAAC;wCACpC,WAAU;wCACV,OAAM;;4CACP;4CACqB,YAAY,MAAM;;;;;;;kDAGxC,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,SAAS;oDACP,MAAM,IAAI,KAAK,GAAG,CAAC,GAAG,OAAO;oDAC7B,QAAQ;oDACR,KAAK;gDACP;gDACA,UAAU,QAAQ,KAAK;gDACvB,WAAU;gDACV,cAAW;0DAEX,cAAA,6LAAC,sOAAW;oDAAC,MAAM;;;;;;;;;;;0DAErB,6LAAC;gDAAI,WAAU;;oDACZ;oDAAK;oDAAE;;;;;;;0DAEV,6LAAC;gDACC,SAAS;oDACP,MAAM,IAAI,KAAK,GAAG,CAAC,OAAO,OAAO;oDACjC,QAAQ;oDACR,KAAK;gDACP;gDACA,UAAU,QAAQ,SAAS;gDAC3B,WAAU;gDACV,cAAW;0DAEX,cAAA,6LAAC,yOAAY;oDAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAO9B,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;kDAAI;;;;;;kDACL,6LAAC;kDAAI;;;;;;kDACL,6LAAC;kDAAI;;;;;;kDACL,6LAAC;wCAAI,WAAU;kDAAmB;;;;;;;;;;;;4BAGnC,oBACC,6LAAC;gCAAI,WAAU;;oCACZ;oCAAK;kDACN,6LAAC;wCAAO,SAAS,IAAM,KAAK;wCAAO,WAAU;kDAAmC;;;;;;;;;;;uCAIhF,wBACF,6LAAC;gCAAI,WAAU;0CACZ,MAAM,IAAI,CAAC;oCAAE,QAAQ;gCAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,6LAAC,iBAAiB;;;;;;;;;uCAGpB,SAAS,MAAM,KAAK,kBACtB,6LAAC;gCAAI,WAAU;0CAA4B;;;;;qDAE3C,6LAAC;gCAAI,WAAU;0CACZ,SAAS,GAAG,CAAC,CAAC,IAAI;oCACjB,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI,WAAW,CAAC,MAAM,CAAC;oCAC5C,MAAM,YAAY,OAAO;oCACzB,MAAM,OAAO,QAAQ,GAAG,OAAO,KAAK;oCACpC,MAAM,QAAQ,GAAG,IAAI,IAAI,GAAG,KAAK,IAAI;oCAErC,4DAA4D;oCAC5D,MAAM,OAAO,AAAC,MAAyC,OAApC,mBAAmB,GAAG,OAAO,GAAE,OAE9C,OAFmD,mBACrD,QACuD,OAArD,GAAG,KAAK,GAAG,AAAC,MAAkC,OAA7B,mBAAmB,GAAG,KAAK,KAAM;oCAEtD,qBACE,6LAAC,0KAAI;wCACH,MAAM;wCAEN,WAAW,AAAC,4LAEX,OADC,OAAO,uBAAuB;wCAEhC,cAAY,AAAC,mBAAwB,OAAN;;0DAE/B,6LAAC;gDAAI,WAAU;;oDACZ,0BACC,6LAAC,gNAAK;wDACJ,MAAM;wDACN,WACE,QAAQ,IACJ,oBACA,QAAQ,IACR,mBACA;wDAEN,aAAW;;;;;6EAGb,6LAAC;wDAAK,WAAU;kEAA6B;;;;;;kEAE/C,6LAAC;wDAAK,WAAU;;4DAAU;4DAAS;;;;;;;;;;;;;0DAGrC,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;kEACZ,CAAC,SAAS,GAAG,EAAE,KAAK,CAAC,GAAG,GAAG,WAAW;;;;;;kEAEzC,6LAAC;wDAAI,WAAU;;0EACb,6LAAC;gEAAI,WAAU;0EACb,cAAA,6LAAC;oEAAK,WAAU;8EAAY;;;;;;;;;;;0EAO9B,6LAAC;gEAAI,WAAU;0EACZ,GAAG,KAAK,IAAI;;;;;;;;;;;;;;;;;;0DAKnB,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;oDAAY,OAAO,GAAG,MAAM;oDAAE,KAAK;;;;;;;;;;;0DAGtC,6LAAC;gDAAI,WAAU;0DACZ,GAAG,MAAM,CAAC,cAAc,CAAC;;;;;;;uCAjDvB,AAAC,GAAgB,OAAd,GAAG,OAAO,EAAC,KAAO,OAAJ;;;;;gCAqD5B;;;;;;;;;;;;kCAKN,6LAAC;wBAAM,WAAU;;0CACf,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDAAc;;;;;;kDAC7B,6LAAC;kDAAK;;;;;;;;;;;;0CAER,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,oJAAQ;oCAAC,SAAQ;oCAAiB,QAAO;;;;;;;;;;;;;;;;;;;;;;;YAK/C,0BACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,SAAS,IAAM,YAAY;wBAC3B,aAAW;;;;;;kCAEb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDAAc;;;;;;kDAC7B,6LAAC;wCACC,WAAU;wCACV,SAAS,IAAM,YAAY;wCAC3B,cAAW;kDAEX,cAAA,6LAAC,oMAAC;4CAAC,MAAM;;;;;;;;;;;;;;;;;0CAGb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,oJAAQ;oCAAC,SAAQ;oCAAiB,QAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxD;GAvSS;MAAA","debugId":null}}]
}